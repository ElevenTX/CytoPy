

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>cytopy.flow.clustering &mdash; CytoPy 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="cytopy.flow.batch_effects" href="cytopy.flow.batch_effects.html" />
    <link rel="prev" title="cytopy.flow.supervised" href="cytopy.flow.supervised.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> CytoPy
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#using-python">Using Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#installing-mongodb">Installing MongoDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#installing-cytopy">Installing CytoPy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../data.html">Data uploading</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../data.html#connecting-to-the-database">Connecting to the database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data.html#projects-subjects">Projects &amp; Subjects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data.html#adding-cytometry-data">Adding Cytometry data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data.html#cytometry-panels">Cytometry Panels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data.html#creating-fcsexperiments">Creating FCSExperiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data.html#adding-fcs-files">Adding *.fcs files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gating.html">Pre-processing with autonomous gates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gating.html#the-gating-and-template-class">The Gating and Template class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gating.html#plotting-a-population">Plotting a population</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gating.html#creating-and-applying-a-gate">Creating and applying a gate</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gating.html#types-of-gates">Types of Gates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gating.html#densitythreshold">DensityThreshold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gating.html#quantile">Quantile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gating.html#densityclustering">DensityClustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gating.html#mixturemodel">MixtureModel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gating.html#static">Static</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gating.html#using-control-data">Using control data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gating.html#editing-gate">Editing gate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gating.html#other-worthy-mentions">Other worthy mentions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../batch.html">Batch-effect analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classify.html">Supervised cell classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cluster.html">High-dimensional clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Feature extraction, selection, and description</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../reference.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.fcs.html">cytopy.data.fcs</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.fcs_experiments.html">cytopy.data.fcs_experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.gating.html">cytopy.data.gating</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.mongo_setup.html">cytopy.data.mongo_setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.panel.html">cytopy.data.panel</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.project.html">cytopy.data.project</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.subject.html">cytopy.data.subject</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.utilities.html">cytopy.data.utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.base.html">cytopy.flow.gating.base</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.actions.html">cytopy.flow.gating.actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.plotting.html">cytopy.flow.gating.plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.control.html">cytopy.flow.gating.control</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.dbscan.html">cytopy.flow.gating.dbscan</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.defaults.html">cytopy.flow.gating.defaults</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.density.html">cytopy.flow.gating.density</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.mixturemodel.html">cytopy.flow.gating.mixturemodel</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.quantile.html">cytopy.flow.gating.quantile</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.static.html">cytopy.flow.gating.static</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.utilities.html">cytopy.flow.gating.utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.supervised.html">cytopy.flow.supervised</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">cytopy.flow.clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.batch_effects.html">cytopy.flow.batch_effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.dim_reduction.html">cytopy.flow.dim_reductions</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.feature_extraction.html">cytopy.flow.feature_extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.feedback.html">cytopy.flow.feedback</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.read_write.html">cytopy.flow.read_write</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.transforms.html">cytopy.flow.transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.utilities.html">cytopy.flow.utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CytoPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../reference.html">API Reference</a> &raquo;</li>
        
      <li>cytopy.flow.clustering</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/cytopy.flow.clustering.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-cytopy.flow.clustering.main">
<span id="cytopy-flow-clustering"></span><h1>cytopy.flow.clustering<a class="headerlink" href="#module-cytopy.flow.clustering.main" title="Permalink to this headline">¶</a></h1>
<p><strong>Classes</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.Clustering" title="cytopy.flow.clustering.main.Clustering"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Clustering</span></code></a>(clustering_definition)</p></td>
<td><p>Parent class for Clustering.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.Explorer" title="cytopy.flow.clustering.main.Explorer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Explorer</span></code></a>(data, path)</p></td>
<td><p>The Explorer class is used to visualise the results of a clustering analysis and explore the results in contrast to patient meta-data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.GlobalClustering" title="cytopy.flow.clustering.main.GlobalClustering"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GlobalClustering</span></code></a>(**kwargs)</p></td>
<td><p>Sample data from all (or some) samples in an FCS Experiment and perform clustering on the concatenated dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.MetaClustering" title="cytopy.flow.clustering.main.MetaClustering"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MetaClustering</span></code></a>(experiment, samples, scale, …)</p></td>
<td><p>Perform meta-clustering; this is when, given a list of samples that have already been clustered, find groupings (cluster of the clusters) that describe the commonality between individual clustering.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.SingleClustering" title="cytopy.flow.clustering.main.SingleClustering"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SingleClustering</span></code></a>(**kwargs)</p></td>
<td><p>Perform clustering on a single fcs file group.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.filter_dict" title="cytopy.flow.clustering.main.filter_dict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">filter_dict</span></code></a>(d, keys)</p></td>
<td><p>Given a dictionary, filter the contents and return a new dictionary containing the given keys</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.meta_dict_lookup" title="cytopy.flow.clustering.main.meta_dict_lookup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">meta_dict_lookup</span></code></a>(key)</p></td>
<td><p>Lookup a value in the Meta Data dictionary; this collection contains a description of meta data variables and can</p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="cytopy.flow.clustering.main.Clustering">
<em class="property">class </em><code class="sig-prename descclassname">cytopy.flow.clustering.main.</code><code class="sig-name descname">Clustering</code><span class="sig-paren">(</span><em class="sig-param">clustering_definition: cytopy.data.fcs.ClusteringDefinition</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.Clustering" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Parent class for Clustering. Provides access to universal cluster method. Clustering objects generate a new
pandas dataframe where either single cell data (or a summary of single cell data) are assigned to clusters,
this assignment is stored in a new column named ‘cluster_id’ (or ‘meta_cluster_id’; see MetaClustering)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ce</strong> (<a class="reference internal" href="cytopy.data.fcs.html#cytopy.data.fcs.ClusteringDefinition" title="cytopy.data.fcs.ClusteringDefinition"><em>ClusteringDefinition</em></a>) – A clustering definition saved to the underlying database and reused across multiple projects</p></li>
<li><p><strong>data</strong> (<em>Pandas.DataFrame</em>) – a Pandas DataFrame that is populated with clustering information can be passed onto the
Explorer class for visualisation</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.Clustering.cluster" title="cytopy.flow.clustering.main.Clustering.cluster"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cluster</span></code></a>()</p></td>
<td><p>Perform clustering analysis as specified by the ClusteringDefinition.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="cytopy.flow.clustering.main.Clustering.cluster">
<code class="sig-name descname">cluster</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; numpy.array<a class="headerlink" href="#cytopy.flow.clustering.main.Clustering.cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform clustering analysis as specified by the ClusteringDefinition. Valid methods currently include PhenoGraph
and FlowSOM. Returns clustering assignments.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Numpy array of clustering assignments.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Numpy.array</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="cytopy.flow.clustering.main.Explorer">
<em class="property">class </em><code class="sig-prename descclassname">cytopy.flow.clustering.main.</code><code class="sig-name descname">Explorer</code><span class="sig-paren">(</span><em class="sig-param">data: pandas.core.frame.DataFrame = None</em>, <em class="sig-param">path: str = None</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.Explorer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The Explorer class is used to visualise the results of a clustering analysis and explore the results in
contrast to patient meta-data. The user should provide a Pandas DataFrame derived from one of the clustering
objects SingleClustering, GlobalClustering, or MetaClustering. Alternatively the user can provide a path name for
a previously saved Explorer dataframe. At a minimum this dataframe (which contains single cell data or summary
single cell data if MetaClustering) should have a column called ‘pt_id’ which contains the patient ID for each cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Pandas.DataFrame</em>) – a Pandas DataFrame generated from a Clustering object</p></li>
<li><p><strong>path</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to existing Pandas.DataFrame as a csv file</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.Explorer.dimenionality_reduction" title="cytopy.flow.clustering.main.Explorer.dimenionality_reduction"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimenionality_reduction</span></code></a>(method, features, …)</p></td>
<td><p>Performs dimensionality reduction and saves the result to the contained dataframe.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.Explorer.drop_data" title="cytopy.flow.clustering.main.Explorer.drop_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">drop_data</span></code></a>(mask)</p></td>
<td><p>Update contained dataframe according to a given mask.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.Explorer.heatmap" title="cytopy.flow.clustering.main.Explorer.heatmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">heatmap</span></code></a>(heatmap_var, features, clustermap, …)</p></td>
<td><p>Generate a heatmap of marker expression for either clusters or gated populations</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.Explorer.info" title="cytopy.flow.clustering.main.Explorer.info"><code class="xref py py-obj docutils literal notranslate"><span class="pre">info</span></code></a>()</p></td>
<td><p>Print a description of the DataFrame contained within</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.Explorer.load_biology_data" title="cytopy.flow.clustering.main.Explorer.load_biology_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_biology_data</span></code></a>(test_name, summary_method)</p></td>
<td><p>Load the pathology results of a given test from each patient and populate ‘data’ accordingly.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.Explorer.load_infectious_data" title="cytopy.flow.clustering.main.Explorer.load_infectious_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_infectious_data</span></code></a>(multi_org)</p></td>
<td><p>Load the bug data from each patient and populate ‘data’ accordingly.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.Explorer.load_meta" title="cytopy.flow.clustering.main.Explorer.load_meta"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_meta</span></code></a>(variable)</p></td>
<td><p>Load meta data for each patient.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.Explorer.plot_2d" title="cytopy.flow.clustering.main.Explorer.plot_2d"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_2d</span></code></a>(primary_id, x, y, secondary_id, …)</p></td>
<td><p>Plots two-dimensions as either a scatter plot or a 2D histogram (defaults to 2D histogram if number of data-points exceeds 1000).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.Explorer.plot_representation" title="cytopy.flow.clustering.main.Explorer.plot_representation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_representation</span></code></a>(x_variable, y_variable, …)</p></td>
<td><p>Present a breakdown of how a variable is represented in relation to a cluster/population/meta cluster</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.Explorer.save" title="cytopy.flow.clustering.main.Explorer.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>(path)</p></td>
<td><p>Save the contained dataframe to a new csv file</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.Explorer.scatter_plot" title="cytopy.flow.clustering.main.Explorer.scatter_plot"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scatter_plot</span></code></a>(label, features, discrete, …)</p></td>
<td><p>Generate a 2D/3D scatter plot (dimensions depends on the number of components chosen for dimensionality reduction.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="cytopy.flow.clustering.main.Explorer.dimenionality_reduction">
<code class="sig-name descname">dimenionality_reduction</code><span class="sig-paren">(</span><em class="sig-param">method: str</em>, <em class="sig-param">features: list</em>, <em class="sig-param">n_components: int = 2</em>, <em class="sig-param">overwrite: bool = False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#cytopy.flow.clustering.main.Explorer.dimenionality_reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs dimensionality reduction and saves the result to the contained dataframe. Resulting embeddings
are saved to columns named as follows: {method}_{n} where n is an integer in range 0 to n_components</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – method to use for dimensionality reduction; valid methods are ‘tSNE’, ‘UMAP’, ‘PHATE’ or ‘PCA’</p></li>
<li><p><strong>features</strong> (<em>list</em>) – list of features to use for dimensionality reduction</p></li>
<li><p><strong>n_components</strong> (<em>int</em><em>, </em><em>(</em><em>default = 2</em><em>)</em>) – number of components to generate</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>(</em><em>default = False</em><em>)</em>) – If True, existing embeddings will be overwritten (default = False)</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments to pass to dim reduction algorithm (see flow.dim_reduction)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.Explorer.drop_data">
<code class="sig-name descname">drop_data</code><span class="sig-paren">(</span><em class="sig-param">mask: pandas.core.frame.DataFrame</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#cytopy.flow.clustering.main.Explorer.drop_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Update contained dataframe according to a given mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mask</strong> (<em>Pandas.DataFrame</em>) – Valid pandas dataframe mask</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.Explorer.heatmap">
<code class="sig-name descname">heatmap</code><span class="sig-paren">(</span><em class="sig-param">heatmap_var: str</em>, <em class="sig-param">features: list</em>, <em class="sig-param">clustermap: bool = False</em>, <em class="sig-param">mask: pandas.core.frame.DataFrame = None</em>, <em class="sig-param">normalise: bool = True</em>, <em class="sig-param">figsize: tuple = (10</em>, <em class="sig-param">5)</em>, <em class="sig-param">title: str = None</em>, <em class="sig-param">col_cluster: bool = False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.Explorer.heatmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a heatmap of marker expression for either clusters or gated populations
(indicated with ‘heatmap_var’ argument)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>heatmap_var</strong> (<em>str</em>) – variable to use, either ‘global clusters’ or ‘gated populations’</p></li>
<li><p><strong>features</strong> (<em>list</em>) – list of column names to use for generating heatmap</p></li>
<li><p><strong>clustermap</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – if True, rows (clusters/populations) are grouped by single linkage clustering</p></li>
<li><p><strong>mask</strong> (<em>Pandas.DataFrame</em><em>, </em><em>optional</em>) – a valid Pandas DataFrame mask to subset data prior to plotting (optional)</p></li>
<li><p><strong>normalise</strong> (<em>bool</em><em>, </em><em>(</em><em>default=True</em><em>)</em>) – if True, data is normalised prior to plotting (normalised using Sklean’s MinMaxScaler function)</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>(</em><em>default=</em><em>(</em><em>10</em><em>,</em><em>5</em><em>)</em><em>)</em>) – tuple defining figure size passed to matplotlib call</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>optional</em>) – figure title</p></li>
<li><p><strong>col_cluster</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True and clustermap is True, columns AND rows are clustered</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.axes</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.Explorer.info">
<code class="sig-name descname">info</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#cytopy.flow.clustering.main.Explorer.info" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a description of the DataFrame contained within</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.Explorer.load_biology_data">
<code class="sig-name descname">load_biology_data</code><span class="sig-paren">(</span><em class="sig-param">test_name: str</em>, <em class="sig-param">summary_method: str = 'average'</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.Explorer.load_biology_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the pathology results of a given test from each patient and populate ‘data’ accordingly. As multiple
results may exist for one particular test, a summary method should be provided, this should have a value as
follows:
* average - the average test result is generated and stored
* max - the maximum value is stored
* min - the minimum value is stored
* median - the median test result is generated and stored</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_name</strong> (<em>str</em>) – Name of test to load</p></li>
<li><p><strong>summary_method</strong> (<em>str</em><em>, </em><em>(</em><em>Default value = 'average'</em><em>)</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.Explorer.load_infectious_data">
<code class="sig-name descname">load_infectious_data</code><span class="sig-paren">(</span><em class="sig-param">multi_org: str = 'list'</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.Explorer.load_infectious_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the bug data from each patient and populate ‘data’ accordingly. As default variables will be created as
follows:
* organism_name = If ‘multi_org’ equals ‘list’ then multiple organisms will be stored as a comma separated list
without duplicates, whereas if the value is ‘mixed’ then multiple organisms will result in a value of ‘mixed’.
* organism_type = value of either ‘gram positive’, ‘gram negative’, ‘virus’, ‘mixed’ or ‘fungal’
* hmbpp = True or False based on HMBPP status (Note: it only takes one positive organism for this value to be
True)
* ribo = True or False based on Ribo status (Note: it only takes one positive organism for this value to be
True)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>multi_org</strong> (<em>str</em><em> (</em><em>Default value = 'list'</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.Explorer.load_meta">
<code class="sig-name descname">load_meta</code><span class="sig-paren">(</span><em class="sig-param">variable: str</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#cytopy.flow.clustering.main.Explorer.load_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Load meta data for each patient. Must be provided with a variable that is a field with a single value
NOT an embedded document. A column will be generated in the Pandas DataFrame stored in the attribute ‘data’
that pertains to the variable given and the value will correspond to that of the patients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>variable</strong> (<em>str</em>) – field name to populate data with</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.Explorer.plot_2d">
<code class="sig-name descname">plot_2d</code><span class="sig-paren">(</span><em class="sig-param">primary_id: dict</em>, <em class="sig-param">x: str</em>, <em class="sig-param">y: str</em>, <em class="sig-param">secondary_id: dict = None</em>, <em class="sig-param">xlim: tuple = None</em>, <em class="sig-param">ylim: tuple = None</em><span class="sig-paren">)</span> &#x2192; matplotlib.axes._axes.Axes<a class="headerlink" href="#cytopy.flow.clustering.main.Explorer.plot_2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots two-dimensions as either a scatter plot or a 2D histogram (defaults to 2D histogram if number of
data-points exceeds 1000). This can be used for close inspection of populations in contrast to their clustering
assignments. Particularly useful for debugging or inspecting anomalies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>primary_id</strong> (<em>dict</em>) – variable for selection of primary dataset to plot, e.g. if primary ID is a population name,
then only data-points belonging to that gated population will be displayed. Alternatively if it is the name of
a cluster or meta-cluster, then only data-points assigned to that cluster will be displayed.</p></li>
<li><p><strong>secondary_id</strong> (<em>dict</em><em>, </em><em>optional</em>) – variable for selection of secondary dataset, plotted over the top of the primary dataset for comparison</p></li>
<li><p><strong>x</strong> (<em>str</em>) – Name of variable to plot on the x-axis</p></li>
<li><p><strong>y</strong> (<em>str</em>) – Name of variable to plot on the y-axis</p></li>
<li><p><strong>xlim</strong> (<em>tuple</em><em>, </em><em>optional</em>) – limit the x-axis to a given range (optional)</p></li>
<li><p><strong>ylim</strong> (<em>tuple</em><em>, </em><em>optional</em>) – limit the y-axis to a given range (optional)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.axes</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.Explorer.plot_representation">
<code class="sig-name descname">plot_representation</code><span class="sig-paren">(</span><em class="sig-param">x_variable: str</em>, <em class="sig-param">y_variable</em>, <em class="sig-param">discrete: bool = True</em>, <em class="sig-param">mask: pandas.core.frame.DataFrame = None</em>, <em class="sig-param">figsize: tuple = (6</em>, <em class="sig-param">6)</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.Explorer.plot_representation" title="Permalink to this definition">¶</a></dt>
<dd><p>Present a breakdown of how a variable is represented in relation to a cluster/population/meta cluster</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_variable</strong> (<em>str</em>) – either cluster, population or meta cluster</p></li>
<li><p><strong>y_variable</strong> (<em>str</em>) – variable for comparison (give a value of ‘patient’ for patient represenation</p></li>
<li><p><strong>discrete</strong> (<em>bool</em><em>, </em><em>(</em><em>default=True</em><em>)</em>) – if True, the variable is assumed to be discrete</p></li>
<li><p><strong>mask</strong> (<em>Pandas.DataFrame</em><em>, </em><em>optional</em>) – a valid Pandas DataFrame mask to subset data prior to plotting (optional)</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>(</em><em>default=</em><em>(</em><em>6</em><em>,</em><em>6</em><em>)</em><em>)</em>) – tuple defining figure size passed to matplotlib call</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.axes</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.Explorer.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param">path: str</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#cytopy.flow.clustering.main.Explorer.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the contained dataframe to a new csv file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – output path for csv file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.Explorer.scatter_plot">
<code class="sig-name descname">scatter_plot</code><span class="sig-paren">(</span><em class="sig-param">label: str</em>, <em class="sig-param">features: list</em>, <em class="sig-param">discrete: bool</em>, <em class="sig-param">populations: list = None</em>, <em class="sig-param">n_components: int = 2</em>, <em class="sig-param">dim_reduction_method: str = 'UMAP'</em>, <em class="sig-param">mask: pandas.core.frame.DataFrame = None</em>, <em class="sig-param">figsize: tuple = (12</em>, <em class="sig-param">8)</em>, <em class="sig-param">meta: bool = False</em>, <em class="sig-param">meta_scale_factor: int = 100</em>, <em class="sig-param">dim_reduction_kwargs: dict = None</em>, <em class="sig-param">matplotlib_kwargs: dict = None</em><span class="sig-paren">)</span> &#x2192; matplotlib.axes._axes.Axes<a class="headerlink" href="#cytopy.flow.clustering.main.Explorer.scatter_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a 2D/3D scatter plot (dimensions depends on the number of components chosen for dimensionality
reduction. Each data point is labelled according to the option provided to the label arguments. If a value
is given to both primary and secondary label, the secondary label colours the background and the primary label
colours the foreground of each datapoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – option for the primary label, must be one of the following:
* A valid column name in Explorer attribute ‘data’ (check valid column names using Explorer.data.columns)
* ‘global clusters’ - requires that phenograph_clustering method has been called prior to plotting. Each data
point will be coloured according to cluster association.
* ‘gated populations’ - each data point is coloured according to population identified by prior gating</p></li>
<li><p><strong>features</strong> (<em>list</em>) – list of column names used as feature space for dimensionality reduction</p></li>
<li><p><strong>discrete</strong> (<em>bool</em>) – Are the labels for this plot discrete or continuous? If True, labels will be treated as
discrete, otherwise labels will be coloured using a gradient and a colourbar will be provided.</p></li>
<li><p><strong>populations</strong> (<em>list</em><em>, </em><em>optional</em>) – if primary/secondary label has value of ‘gated populations’, only populations in this
list will be included (events with no population associated will be labelled ‘None’)</p></li>
<li><p><strong>n_components</strong> (<em>int</em><em>, </em><em>(</em><em>default=2</em><em>)</em>) – number of components to produce from dimensionality reduction, valid values are 2 or 3</p></li>
<li><p><strong>dim_reduction_method</strong> (<em>str</em><em>, </em><em>(</em><em>default = 'UMAP'</em><em>)</em>) – method to use for dimensionality reduction, valid values are ‘UMAP’ or ‘PHATE’</p></li>
<li><p><strong>mask</strong> (<em>Pandas.DataFrame</em><em>, </em><em>optional</em>) – a valid Pandas DataFrame mask to subset data prior to plotting</p></li>
<li><p><strong>figsize</strong> (<em>tuple</em><em>, </em><em>(</em><em>default=</em><em>(</em><em>12</em><em>,</em><em>8</em><em>)</em><em>)</em>) – tuple of figure size to pass to matplotlib call</p></li>
<li><p><strong>meta</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – if True, data is assumed to come from meta-clustering</p></li>
<li><p><strong>meta_scale_factor</strong> (<em>int</em><em>, </em><em>(</em><em>default=100</em><em>)</em>) – if meta is True, scale factor defines the size of datapoints;
size = meta_scale_factor * proportion of events in cluster relative to root population</p></li>
<li><p><strong>dim_reduction_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – additional keyword arguments to pass to dimensionality reduction algorithm</p></li>
<li><p><strong>matplotlib_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – additional keyword arguments to pass to matplotlib call</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.axes</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="cytopy.flow.clustering.main.GlobalClustering">
<em class="property">class </em><code class="sig-prename descclassname">cytopy.flow.clustering.main.</code><code class="sig-name descname">GlobalClustering</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.GlobalClustering" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cytopy.flow.clustering.main.Clustering" title="cytopy.flow.clustering.main.Clustering"><code class="xref py py-class docutils literal notranslate"><span class="pre">cytopy.flow.clustering.main.Clustering</span></code></a></p>
<p>Sample data from all (or some) samples in an FCS Experiment and perform clustering on the concatenated dataset.
This is useful when you want to look at some global change in immunological topology and batch effects are minimal.</p>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.GlobalClustering.cluster" title="cytopy.flow.clustering.main.GlobalClustering.cluster"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cluster</span></code></a>()</p></td>
<td><p>Perform clustering as specified in the Clustering Definition.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.GlobalClustering.explorer" title="cytopy.flow.clustering.main.GlobalClustering.explorer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">explorer</span></code></a>()</p></td>
<td><p>Returns an Explorer object with the single cell data and clusters, for plotting and exploring meta-data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.GlobalClustering.load_data" title="cytopy.flow.clustering.main.GlobalClustering.load_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_data</span></code></a>(experiment, samples, sample_n)</p></td>
<td><p>Load fcs file data, including any associated gates or clusters</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="cytopy.flow.clustering.main.GlobalClustering.cluster">
<code class="sig-name descname">cluster</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.GlobalClustering.cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform clustering as specified in the Clustering Definition.</p>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.GlobalClustering.explorer">
<code class="sig-name descname">explorer</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; cytopy.flow.clustering.main.Explorer<a class="headerlink" href="#cytopy.flow.clustering.main.GlobalClustering.explorer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an Explorer object with the single cell data and clusters, for plotting and exploring meta-data.
See flow.clustering.main.Explorer for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#cytopy.flow.clustering.main.Explorer" title="cytopy.flow.clustering.main.Explorer">Explorer</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.GlobalClustering.load_data">
<code class="sig-name descname">load_data</code><span class="sig-paren">(</span><em class="sig-param">experiment: cytopy.data.fcs_experiments.FCSExperiment</em>, <em class="sig-param">samples: list = 'all'</em>, <em class="sig-param">sample_n: int = 1000</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.GlobalClustering.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load fcs file data, including any associated gates or clusters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment</strong> (<a class="reference internal" href="cytopy.data.fcs_experiments.html#cytopy.data.fcs_experiments.FCSExperiment" title="cytopy.data.fcs_experiments.FCSExperiment"><em>FCSExperiment</em></a>) – FCSExperiment to load samples from</p></li>
<li><p><strong>samples</strong> (<em>list</em><em> or </em><em>str</em><em>, </em><em>(</em><em>Default value = 'all'</em><em>)</em>) – list of sample IDs (if value = ‘all’, then all samples from FCS Experiment are used)</p></li>
<li><p><strong>sample_n</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>(</em><em>Default value = 1000</em><em>)</em>) – if an integer value is provided, each file will be downsampled to the indicated
amount (optional)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="cytopy.flow.clustering.main.MetaClustering">
<em class="property">class </em><code class="sig-prename descclassname">cytopy.flow.clustering.main.</code><code class="sig-name descname">MetaClustering</code><span class="sig-paren">(</span><em class="sig-param">experiment: cytopy.data.fcs_experiments.FCSExperiment</em>, <em class="sig-param">samples: str = 'all'</em>, <em class="sig-param">scale: str = 'norm'</em>, <em class="sig-param">load_existing_meta: bool = False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.MetaClustering" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cytopy.flow.clustering.main.Clustering" title="cytopy.flow.clustering.main.Clustering"><code class="xref py py-class docutils literal notranslate"><span class="pre">cytopy.flow.clustering.main.Clustering</span></code></a></p>
<p>Perform meta-clustering; this is when, given a list of samples that have already been clustered, find groupings
(cluster of the clusters) that describe the commonality between individual clustering.
Performing clustering on individual samples has the benefit in that clustering will not be disrupted by batch effect
(technical variation between patients) but we must find a way of contrasting the clustering between patients. This
is what this class is for. The approach taken is that each clusters centroid is calculated (the median of each
feature) and these centroids form a new multi-dimensional data point which are then subsequently clustered.
Clustering is performed either by a single run of PhenoGraph clustering, or by Consensus Clustering.
For stable clusters it is recommended to use Consensus Clustering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment</strong> (<a class="reference internal" href="cytopy.data.fcs_experiments.html#cytopy.data.fcs_experiments.FCSExperiment" title="cytopy.data.fcs_experiments.FCSExperiment"><em>FCSExperiment</em></a>) – This is the FCS Experiment that samples will be taken from</p></li>
<li><p><strong>samples</strong> (<em>str</em><em> or </em><em>list</em><em>, </em><em>(</em><em>default='all'</em><em>)</em>) – list of sample names to extract clusters from associated experiment</p></li>
<li><p><strong>scale</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>(</em><em>default='norm'</em><em>)</em>) – scaling function to apply to data prior to clustering</p></li>
<li><p><strong>load_existing_meta</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, existing meta-clusters (with the meta-clustering UID in the clustering definition) will be loaded
into the object</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.MetaClustering.cluster" title="cytopy.flow.clustering.main.MetaClustering.cluster"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cluster</span></code></a>()</p></td>
<td><p>Perform clustering as defined by clustering definition.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.MetaClustering.explorer" title="cytopy.flow.clustering.main.MetaClustering.explorer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">explorer</span></code></a>()</p></td>
<td><p>Returns an Explorer object with the single cell data and clusters, for plotting and exploring meta-data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.MetaClustering.inspect_heatmap" title="cytopy.flow.clustering.main.MetaClustering.inspect_heatmap"><code class="xref py py-obj docutils literal notranslate"><span class="pre">inspect_heatmap</span></code></a>(**kwargs)</p></td>
<td><p>Generate a clustered heatmap of clustering results.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.MetaClustering.label_cluster" title="cytopy.flow.clustering.main.MetaClustering.label_cluster"><code class="xref py py-obj docutils literal notranslate"><span class="pre">label_cluster</span></code></a>(meta_cluster_id, new_id, prefix)</p></td>
<td><p>Given an existing meta cluster ID and a new replacement ID, update meta clustering IDs</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.MetaClustering.load_clusters" title="cytopy.flow.clustering.main.MetaClustering.load_clusters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_clusters</span></code></a>(samples)</p></td>
<td><p>Load the clusters from each sample and populate a new dataframe.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.MetaClustering.load_existing_clusters" title="cytopy.flow.clustering.main.MetaClustering.load_existing_clusters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_existing_clusters</span></code></a>()</p></td>
<td><p>Load existing meta-cluster ID for each cluster (note: a cluster can only ever have one meta-cluster ID).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.MetaClustering.save" title="cytopy.flow.clustering.main.MetaClustering.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>()</p></td>
<td><p>Save results of meta-clustering to underlying database</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="cytopy.flow.clustering.main.MetaClustering.cluster">
<code class="sig-name descname">cluster</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.MetaClustering.cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform clustering as defined by clustering definition. Clustering results saved to DataFrame
in ‘meta_cluster_id’ column.</p>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.MetaClustering.explorer">
<code class="sig-name descname">explorer</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; cytopy.flow.clustering.main.Explorer<a class="headerlink" href="#cytopy.flow.clustering.main.MetaClustering.explorer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an Explorer object with the single cell data and clusters, for plotting and exploring meta-data.
See flow.clustering.main.Explorer for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#cytopy.flow.clustering.main.Explorer" title="cytopy.flow.clustering.main.Explorer">Explorer</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.MetaClustering.inspect_heatmap">
<code class="sig-name descname">inspect_heatmap</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.MetaClustering.inspect_heatmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a clustered heatmap of clustering results. Rows are coloured according to population labels (as generated
by gating)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Additional keyword arguments to pass to call to Seaborn.clustermap</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.axes</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.MetaClustering.label_cluster">
<code class="sig-name descname">label_cluster</code><span class="sig-paren">(</span><em class="sig-param">meta_cluster_id: str</em>, <em class="sig-param">new_id: str</em>, <em class="sig-param">prefix: str = 'cluster'</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.MetaClustering.label_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an existing meta cluster ID and a new replacement ID, update meta clustering IDs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>meta_cluster_id</strong> (<em>str</em>) – meta cluster ID to be replaced</p></li>
<li><p><strong>new_id</strong> (<em>str</em>) – new ID to use</p></li>
<li><p><strong>prefix</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>(</em><em>Default value = 'cluster'</em><em>)</em>) – optional prefix to append to new ID (default = “cluster”)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.MetaClustering.load_clusters">
<code class="sig-name descname">load_clusters</code><span class="sig-paren">(</span><em class="sig-param">samples: list</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.clustering.main.MetaClustering.load_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the clusters from each sample and populate a new dataframe. Each row of the dataframe corresponds to
a unique cluster from an individual patient sample, with the values of each feature being the median (centroid
of this cluster).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>list</em>) – List of samples to fetch from the experiment</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.MetaClustering.load_existing_clusters">
<code class="sig-name descname">load_existing_clusters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.MetaClustering.load_existing_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Load existing meta-cluster ID for each cluster (note: a cluster can only ever have one meta-cluster ID).
Meta-clusters are saved to DataFrame in column ‘meta_cluster_id’.</p>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.MetaClustering.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.MetaClustering.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save results of meta-clustering to underlying database</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="cytopy.flow.clustering.main.SingleClustering">
<em class="property">class </em><code class="sig-prename descclassname">cytopy.flow.clustering.main.</code><code class="sig-name descname">SingleClustering</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.SingleClustering" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cytopy.flow.clustering.main.Clustering" title="cytopy.flow.clustering.main.Clustering"><code class="xref py py-class docutils literal notranslate"><span class="pre">cytopy.flow.clustering.main.Clustering</span></code></a></p>
<p>Perform clustering on a single fcs file group. User provides a clustering definition
(see data.clustering.ClusteringExperiment) and then can use ‘load_data’ method to load fcs
data from an FCS experiment and associated sample.
Call ‘cluster’ method to performing clustering using the method described in the clustering definition.
To save the clustering result, use the ‘save_clusters’ method. The resulting clusters will be saved to the
‘root population’ (given in the clustering definition) of the sample FCS file group.
If the user calls ‘load_data’ on a sample with existing clusters in the database, for the clustering definition
given, the object will be populated accordingly. If you wish to overwrite these clusters, class ‘delete_clusters’
followed by ‘save_clusters’ with the ‘overwrite’ argument set to True.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Pandas.DataFrame</em>) – a Pandas DataFrame of FCS single cell data that clustering will be performed upon</p></li>
<li><p><strong>ce</strong> (<a class="reference internal" href="cytopy.data.fcs.html#cytopy.data.fcs.ClusteringDefinition" title="cytopy.data.fcs.ClusteringDefinition"><em>ClusteringDefinition</em></a>) – associated clustering definition</p></li>
<li><p><strong>clusters</strong> (<em>dict</em>) – dictionary object of identified clusters</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.SingleClustering.cluster" title="cytopy.flow.clustering.main.SingleClustering.cluster"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cluster</span></code></a>()</p></td>
<td><p>Perform clustering as described by the clustering definition.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.SingleClustering.delete_clusters" title="cytopy.flow.clustering.main.SingleClustering.delete_clusters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">delete_clusters</span></code></a>()</p></td>
<td><p>All clusters will be deleted from the object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.SingleClustering.explorer" title="cytopy.flow.clustering.main.SingleClustering.explorer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">explorer</span></code></a>()</p></td>
<td><p>Returns an Explorer object with the single cell data and clusters, for plotting and exploring meta-data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.SingleClustering.get_cluster_dataframe" title="cytopy.flow.clustering.main.SingleClustering.get_cluster_dataframe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_cluster_dataframe</span></code></a>(cluster_id, meta)</p></td>
<td><p>Return a Pandas DataFrame of single cell data for a single cluster.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.SingleClustering.load_data" title="cytopy.flow.clustering.main.SingleClustering.load_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_data</span></code></a>(experiment, sample_id, …)</p></td>
<td><p>Given some FCS Experiment and the name of a sample associated to that experiment, populate the ‘data’ parameter with single cell data from the given sample and FCS experiment.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.main.SingleClustering.save_clusters" title="cytopy.flow.clustering.main.SingleClustering.save_clusters"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_clusters</span></code></a>(overwrite)</p></td>
<td><p>Clusters will be saved to the root population of associated sample.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="cytopy.flow.clustering.main.SingleClustering.cluster">
<code class="sig-name descname">cluster</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.SingleClustering.cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform clustering as described by the clustering definition.
Results saved to internal attribute ‘clusters’.</p>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.SingleClustering.delete_clusters">
<code class="sig-name descname">delete_clusters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.SingleClustering.delete_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>All clusters will be deleted from the object.</p>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.SingleClustering.explorer">
<code class="sig-name descname">explorer</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; cytopy.flow.clustering.main.Explorer<a class="headerlink" href="#cytopy.flow.clustering.main.SingleClustering.explorer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an Explorer object with the single cell data and clusters, for plotting and exploring meta-data.
See flow.clustering.main.Explorer for details.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#cytopy.flow.clustering.main.Explorer" title="cytopy.flow.clustering.main.Explorer">Explorer</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.SingleClustering.get_cluster_dataframe">
<code class="sig-name descname">get_cluster_dataframe</code><span class="sig-paren">(</span><em class="sig-param">cluster_id: str</em>, <em class="sig-param">meta: bool = False</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.clustering.main.SingleClustering.get_cluster_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Pandas DataFrame of single cell data for a single cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster_id</strong> (<em>str</em>) – name of cluster to retrieve</p></li>
<li><p><strong>meta</strong> (<em>bool</em><em>, </em><em>(</em><em>Default value = False</em><em>)</em>) – if True, fetch cluster by meta_cluster_id (default = False)
:return DataFrame of events in cluster (Data returned untransformed)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame or None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.SingleClustering.load_data">
<code class="sig-name descname">load_data</code><span class="sig-paren">(</span><em class="sig-param">experiment: cytopy.data.fcs_experiments.FCSExperiment</em>, <em class="sig-param">sample_id: str</em>, <em class="sig-param">include_population_label: bool = True</em>, <em class="sig-param">scale: str = None</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.SingleClustering.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Given some FCS Experiment and the name of a sample associated to that experiment, populate the ‘data’
parameter with single cell data from the given sample and FCS experiment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment</strong> (<a class="reference internal" href="cytopy.data.fcs_experiments.html#cytopy.data.fcs_experiments.FCSExperiment" title="cytopy.data.fcs_experiments.FCSExperiment"><em>FCSExperiment</em></a>) – </p></li>
<li><p><strong>sample_id</strong> (<em>str</em>) – sample identifier</p></li>
<li><p><strong>include_population_label</strong> (<em>bool</em><em>, </em><em>(</em><em>default = True</em><em>)</em>) – if True, data frame populated with population labels from gates</p></li>
<li><p><strong>scale</strong> (<em>str</em><em>, </em><em>optional</em>) – specify how to scale the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.main.SingleClustering.save_clusters">
<code class="sig-name descname">save_clusters</code><span class="sig-paren">(</span><em class="sig-param">overwrite: bool = False</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.main.SingleClustering.save_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Clusters will be saved to the root population of associated sample.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>overwrite</strong> (<em>bool</em><em>, </em><em>(</em><em>Default value = False</em><em>)</em>) – if True, existing clusters in database entry will be overwritten.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="cytopy.flow.clustering.main.filter_dict">
<code class="sig-prename descclassname">cytopy.flow.clustering.main.</code><code class="sig-name descname">filter_dict</code><span class="sig-paren">(</span><em class="sig-param">d: dict</em>, <em class="sig-param">keys: list</em><span class="sig-paren">)</span> &#x2192; dict<a class="headerlink" href="#cytopy.flow.clustering.main.filter_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a dictionary, filter the contents and return a new dictionary containing the given keys</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<em>dict</em>) – dictionary to filter</p></li>
<li><p><strong>keys</strong> (<em>list</em>) – list of keys to include in new dictionary</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>filtered dictionary</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="cytopy.flow.clustering.main.meta_dict_lookup">
<code class="sig-prename descclassname">cytopy.flow.clustering.main.</code><code class="sig-name descname">meta_dict_lookup</code><span class="sig-paren">(</span><em class="sig-param">key: str</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#cytopy.flow.clustering.main.meta_dict_lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Lookup a value in the Meta Data dictionary; this collection contains a description of meta data variables and can
be used for guidance for the user, see data.patient.MetaDataDictionary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> (<em>str</em>) – value to lookup</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Description of given variable or None if variable does not exist</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str or None</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-cytopy.flow.clustering.flowsom"></span><p><strong>Classes</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.flowsom.FlowSOM" title="cytopy.flow.clustering.flowsom.FlowSOM"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FlowSOM</span></code></a>(data, features, …)</p></td>
<td><p>Python implementation of FlowSOM algorithm, adapted from <a class="reference external" href="https://github.com/Hatchin/FlowSOM">https://github.com/Hatchin/FlowSOM</a></p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="cytopy.flow.clustering.flowsom.FlowSOM">
<em class="property">class </em><code class="sig-prename descclassname">cytopy.flow.clustering.flowsom.</code><code class="sig-name descname">FlowSOM</code><span class="sig-paren">(</span><em class="sig-param">data: pandas.core.frame.DataFrame</em>, <em class="sig-param">features: list</em>, <em class="sig-param">neighborhood_function: str = 'gaussian'</em>, <em class="sig-param">normalisation: bool = False</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.flowsom.FlowSOM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Python implementation of FlowSOM algorithm, adapted from <a class="reference external" href="https://github.com/Hatchin/FlowSOM">https://github.com/Hatchin/FlowSOM</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Pandas.DataFrame</em>) – training data</p></li>
<li><p><strong>features</strong> (<em>List</em>) – list of columns to include</p></li>
<li><p><strong>neighborhood_function</strong> (<em>str</em>) – name of distribution for initialising weights</p></li>
<li><p><strong>normalisation</strong> (<em>bool</em>) – if True, min max normalisation applied prior to computation</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.flowsom.FlowSOM.meta_cluster" title="cytopy.flow.clustering.flowsom.FlowSOM.meta_cluster"><code class="xref py py-obj docutils literal notranslate"><span class="pre">meta_cluster</span></code></a>(cluster_class, min_n, max_n, …)</p></td>
<td><p>Perform meta-clustering.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.flowsom.FlowSOM.predict" title="cytopy.flow.clustering.flowsom.FlowSOM.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>()</p></td>
<td><p>Predict the cluster allocation for each cell in the associated dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.flowsom.FlowSOM.train" title="cytopy.flow.clustering.flowsom.FlowSOM.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a>(som_dim, sigma, learning_rate, …)</p></td>
<td><p>Train self-organising map.</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="cytopy.flow.clustering.flowsom.FlowSOM.meta_cluster">
<code class="sig-name descname">meta_cluster</code><span class="sig-paren">(</span><em class="sig-param">cluster_class: callable</em>, <em class="sig-param">min_n: int</em>, <em class="sig-param">max_n: int</em>, <em class="sig-param">iter_n: int</em>, <em class="sig-param">resample_proportion: float = 0.5</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.flowsom.FlowSOM.meta_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform meta-clustering. Implementation of Consensus clustering, following the paper
<a class="reference external" href="https://link.springer.com/content/pdf/10.1023%2FA%3A1023949509487.pdf">https://link.springer.com/content/pdf/10.1023%2FA%3A1023949509487.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster_class</strong> – clustering object (must follow Sklearn standard; needs fit_predict method called with
parameter n_clusters)</p></li>
<li><p><strong>min_n</strong> (<em>int</em>) – the min proposed number of clusters</p></li>
<li><p><strong>max_n</strong> (<em>int</em>) – the max proposed number of clusters</p></li>
<li><p><strong>iter_n</strong> (<em>int</em>) – the iteration times for each number of clusters</p></li>
<li><p><strong>resample_proportion</strong> (<em>float</em><em>, </em><em>(</em><em>Default value = 0.5</em><em>)</em>) – within (0, 1), the proportion of re-sampling when computing clustering</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.flowsom.FlowSOM.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.flowsom.FlowSOM.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict the cluster allocation for each cell in the associated dataset.
(Requires that train and meta_cluster have been called previously)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Predicted labels</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Numpy.array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.flowsom.FlowSOM.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">som_dim: tuple = (250</em>, <em class="sig-param">250)</em>, <em class="sig-param">sigma: float = 1.0</em>, <em class="sig-param">learning_rate: float = 0.5</em>, <em class="sig-param">batch_size: int = 500</em>, <em class="sig-param">seed: int = 42</em>, <em class="sig-param">weight_init: str = 'random'</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.flowsom.FlowSOM.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train self-organising map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>som_dim</strong> (<em>tuple</em><em>, </em><em>(</em><em>default=</em><em>(</em><em>250</em><em>, </em><em>250</em><em>)</em><em>)</em>) – dimensions of SOM embedding (number of nodes)</p></li>
<li><p><strong>sigma</strong> (<em>float</em><em>, </em><em>(</em><em>default=1.0</em><em>)</em>) – the radius of the different neighbors in the SOM, default = 1.0</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em><em>, </em><em>(</em><em>default=0.5</em><em>)</em>) – alters the rate at which weights are updated</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>(</em><em>default=500</em><em>)</em>) – size of batches used in training (alters number of total iterations)</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>(</em><em>default=42</em><em>)</em>) – random seed</p></li>
<li><p><strong>weight_init</strong> (<em>str</em><em>, </em><em>(</em><em>default='random'</em><em>)</em>) – how to initialise weights: either ‘random’ or ‘pca’ (Initializes the weights to span the
first two principal components)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-cytopy.flow.clustering.consensus"></span><p><strong>Classes</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.consensus.ConsensusCluster" title="cytopy.flow.clustering.consensus.ConsensusCluster"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ConsensusCluster</span></code></a>(cluster, …)</p></td>
<td><p>Implementation of Consensus clustering, following the paper</p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="cytopy.flow.clustering.consensus.ConsensusCluster">
<em class="property">class </em><code class="sig-prename descclassname">cytopy.flow.clustering.consensus.</code><code class="sig-name descname">ConsensusCluster</code><span class="sig-paren">(</span><em class="sig-param">cluster: callable</em>, <em class="sig-param">smallest_cluster_n: int</em>, <em class="sig-param">largest_cluster_n: int</em>, <em class="sig-param">n_resamples: int</em>, <em class="sig-param">resample_proportion: float = 0.5</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.consensus.ConsensusCluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="simple">
<dt>Implementation of Consensus clustering, following the paper</dt><dd><p><a class="reference external" href="https://link.springer.com/content/pdf/10.1023%2FA%3A1023949509487.pdf">https://link.springer.com/content/pdf/10.1023%2FA%3A1023949509487.pdf</a>
Code is adapted from <a class="reference external" href="https://github.com/ZigaSajovic/Consensus_Clustering">https://github.com/ZigaSajovic/Consensus_Clustering</a></p>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.consensus.ConsensusCluster.fit" title="cytopy.flow.clustering.consensus.ConsensusCluster.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(data)</p></td>
<td><p>Fits a consensus matrix for each number of clusters</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.clustering.consensus.ConsensusCluster.predict" title="cytopy.flow.clustering.consensus.ConsensusCluster.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>()</p></td>
<td><p>Predicts on the consensus matrix, for best found cluster number</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.clustering.consensus.ConsensusCluster.predict_data" title="cytopy.flow.clustering.consensus.ConsensusCluster.predict_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_data</span></code></a>(data)</p></td>
<td><p>Predicts on the data, for best found cluster number</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster</strong> – clustering class (must be an instance of clustering algorithm with fit/fit_predict method (e.g. scikit-learn)</p></li>
<li><p><strong>L</strong> – smallest number of clusters to try</p></li>
<li><p><strong>K</strong> – biggest number of clusters to try</p></li>
<li><p><strong>H</strong> – number of resamplings for each cluster number</p></li>
<li><p><strong>resample_proportion</strong> – percentage to sample</p></li>
<li><p><strong>Mk</strong> – consensus matrices for each k (OTE: every consensus matrix is retained)</p></li>
<li><p><strong>Ak</strong> – area under CDF for each number of clusters (see paper)</p></li>
<li><p><strong>deltaK</strong> – changes in ares under CDF (see paper)</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="cytopy.flow.clustering.consensus.ConsensusCluster.fit">
<code class="sig-name descname">fit</code><span class="sig-paren">(</span><em class="sig-param">data: numpy.array</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#cytopy.flow.clustering.consensus.ConsensusCluster.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits a consensus matrix for each number of clusters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Numpy.array</em>) – numpy array to fit clustering algorithm too</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.consensus.ConsensusCluster.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.consensus.ConsensusCluster.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts on the consensus matrix, for best found cluster number
:returns:
:rtype: Clustering predictions</p>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.clustering.consensus.ConsensusCluster.predict_data">
<code class="sig-name descname">predict_data</code><span class="sig-paren">(</span><em class="sig-param">data: numpy.array</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.clustering.consensus.ConsensusCluster.predict_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts on the data, for best found cluster number</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>np.array :</em>) – data to make predictions</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Clustering predictions</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cytopy.flow.batch_effects.html" class="btn btn-neutral float-right" title="cytopy.flow.batch_effects" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cytopy.flow.supervised.html" class="btn btn-neutral float-left" title="cytopy.flow.supervised" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Ross Burton

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>