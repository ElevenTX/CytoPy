

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>cytopy.flow.supervised &mdash; CytoPy 0.0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="cytopy.flow.clustering" href="cytopy.flow.clustering.html" />
    <link rel="prev" title="cytopy.flow.gating.utilities" href="cytopy.flow.gating.utilities.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> CytoPy
          

          
            
            <img src="../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#using-python">Using Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#installing-mongodb">Installing MongoDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro.html#installing-cytopy">Installing CytoPy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../data.html">Data uploading</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../data.html#connecting-to-the-database">Connecting to the database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data.html#projects-subjects">Projects &amp; Subjects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data.html#adding-cytometry-data">Adding Cytometry data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../data.html#cytometry-panels">Cytometry Panels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data.html#creating-fcsexperiments">Creating FCSExperiments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data.html#adding-fcs-files">Adding *.fcs files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gating.html">Pre-processing with autonomous gates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gating.html#the-gating-and-template-class">The Gating and Template class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gating.html#plotting-a-population">Plotting a population</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gating.html#creating-and-applying-a-gate">Creating and applying a gate</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gating.html#types-of-gates">Types of Gates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gating.html#densitythreshold">DensityThreshold</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gating.html#quantile">Quantile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gating.html#densityclustering">DensityClustering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gating.html#mixturemodel">MixtureModel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gating.html#static">Static</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gating.html#using-control-data">Using control data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gating.html#editing-gate">Editing gate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gating.html#other-worthy-mentions">Other worthy mentions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../batch.html">Batch-effect analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../batch.html#choosing-a-reference-sample">Choosing a reference sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="../batch.html#evaluatebatcheffects">EvaluateBatchEffects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../batch.html#visualising-univariant-differences">Visualising univariant differences</a></li>
<li class="toctree-l2"><a class="reference internal" href="../batch.html#visualising-multivariant-differences">Visualising multivariant differences</a></li>
<li class="toctree-l2"><a class="reference internal" href="../batch.html#building-a-similarity-matrix">Building a similarity matrix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../classify.html">Single cell phenotype classification by supervised learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classify.html#introducing-the-cellclassifier">Introducing the CellClassifier</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../classify.html#training">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../classify.html#validating">Validating</a></li>
<li class="toctree-l2"><a class="reference internal" href="../classify.html#troubleshooting-with-backgating">Troubleshooting with backgating</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cluster.html">High-dimensional clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Feature extraction, selection, and description</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../reference.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.fcs.html">cytopy.data.fcs</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.fcs_experiments.html">cytopy.data.fcs_experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.gating.html">cytopy.data.gating</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.mongo_setup.html">cytopy.data.mongo_setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.panel.html">cytopy.data.panel</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.project.html">cytopy.data.project</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.subject.html">cytopy.data.subject</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.data.utilities.html">cytopy.data.utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.base.html">cytopy.flow.gating.base</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.actions.html">cytopy.flow.gating.actions</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.plotting.html">cytopy.flow.gating.plotting</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.dbscan.html">cytopy.flow.gating.dbscan</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.defaults.html">cytopy.flow.gating.defaults</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.density.html">cytopy.flow.gating.density</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.mixturemodel.html">cytopy.flow.gating.mixturemodel</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.quantile.html">cytopy.flow.gating.quantile</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.static.html">cytopy.flow.gating.static</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.gating.utilities.html">cytopy.flow.gating.utilities</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">cytopy.flow.supervised</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.clustering.html">cytopy.flow.clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.batch_effects.html">cytopy.flow.batch_effects</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.dim_reduction.html">cytopy.flow.dim_reductions</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.feature_extraction.html">cytopy.flow.feature_extraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.feedback.html">cytopy.flow.feedback</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.read_write.html">cytopy.flow.read_write</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.transforms.html">cytopy.flow.transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="cytopy.flow.utilities.html">cytopy.flow.utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CytoPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../reference.html">API Reference</a> &raquo;</li>
        
      <li>cytopy.flow.supervised</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/cytopy.flow.supervised.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-cytopy.flow.supervised.cell_classifier">
<span id="cytopy-flow-supervised"></span><h1>cytopy.flow.supervised<a class="headerlink" href="#module-cytopy.flow.supervised.cell_classifier" title="Permalink to this headline">¶</a></h1>
<p><strong>Classes</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier" title="cytopy.flow.supervised.cell_classifier.CellClassifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CellClassifier</span></code></a>(experiment, reference_sample, …)</p></td>
<td><p>Base class for performing classification of cells by supervised machine learning.</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.create_reference_sample" title="cytopy.flow.supervised.cell_classifier.create_reference_sample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">create_reference_sample</span></code></a>(experiment[, …])</p></td>
<td><p>Given some experiment and a root population that is common to all fcs file groups within this experiment, take a sample from each and create a new file group from the concatenation of these data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.multi_process_ordered" title="cytopy.flow.supervised.cell_classifier.multi_process_ordered"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multi_process_ordered</span></code></a>(func, x, chunksize)</p></td>
<td><p>Map a function (func) to some iterable (x) using multiprocessing.</p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="cytopy.flow.supervised.cell_classifier.CellClassifier">
<em class="property">class </em><code class="sig-prename descclassname">cytopy.flow.supervised.cell_classifier.</code><code class="sig-name descname">CellClassifier</code><span class="sig-paren">(</span><em class="sig-param">experiment: cytopy.data.fcs_experiments.FCSExperiment</em>, <em class="sig-param">reference_sample: str</em>, <em class="sig-param">population_labels: list</em>, <em class="sig-param">features: list</em>, <em class="sig-param">multi_label: bool = True</em>, <em class="sig-param">transform: str = 'logicle'</em>, <em class="sig-param">root_population: str = 'root'</em>, <em class="sig-param">threshold: float = 0.5</em>, <em class="sig-param">scale: str = 'standard'</em>, <em class="sig-param">balance_method: str = None</em>, <em class="sig-param">frac: float = None</em>, <em class="sig-param">downsampling_kwargs: dict = None</em>, <em class="sig-param">scale_kwargs: dict = None</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.cell_classifier.CellClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for performing classification of cells by supervised machine learning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment</strong> (<a class="reference internal" href="cytopy.data.fcs_experiments.html#cytopy.data.fcs_experiments.FCSExperiment" title="cytopy.data.fcs_experiments.FCSExperiment"><em>FCSExperiment</em></a>) – FCSExperiment for classification</p></li>
<li><p><strong>reference_sample</strong> (<em>str</em>) – sample ID for training sample (see ‘create_reference_sample’)</p></li>
<li><p><strong>population_labels</strong> (<em>list</em>) – list of populations for prediction (populations must be valid gated populations
that exist in the reference sample)</p></li>
<li><p><strong>features</strong> (<em>list</em>) – list of features (channel/marker column names) to include</p></li>
<li><p><strong>multi_label</strong> (<em>bool</em><em>, </em><em>(</em><em>default=True</em><em>)</em>) – If True, cells can belong to multiple classes and the problem is treated as a
‘multi-label’ classification task. Labels will be binarised and a new ‘fake’ label generated for each
unique instance of a cell label. This is important to account for correlations between individual labels.</p></li>
<li><p><strong>transform</strong> (<em>str</em><em>, </em><em>(</em><em>default='logicle'</em><em>)</em>) – name of transform method to use (see flow.gating.transforms for info)</p></li>
<li><p><strong>root_population</strong> (<em>str</em><em>, </em><em>(</em><em>default='root'</em><em>)</em>) – name of root population i.e. the population to derive training and test data from</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>(</em><em>default=0.5</em><em>)</em>) – minimum probability threshold to class as positive</p></li>
<li><p><strong>scale</strong> (<em>str</em><em>, </em><em>(</em><em>default='standard'</em><em>)</em>) – how to scale the data prior to learning; either ‘Standardise’, ‘Normalise’ or None.
Standardise scales using the standard score, removing the mean and scaling to unit variance
(<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html">https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html</a>)
Normalise scales data between 0 and 1 using the MinMaxScaler
(<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html">https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.MinMaxScaler.html</a>)</p></li>
<li><p><strong>balance_method</strong> (<em>str</em><em> or </em><em>dict</em><em>, </em><em>optional</em>) – Methodology to use to combat class imbalance; either a dictionary of class weights or one of the following:
- ‘density’: density dependent downsampling is performed using keyword arguments provided in ‘downsample_kwargs’
- ‘oversample’: classes balanced by oversampling underrepresented classes
‘auto_weights’: weights are calculated automatically using scikit-learn compute_class_weight function</p></li>
<li><p><strong>scale_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – keyword arguments to pass to scaling function</p></li>
<li><p><strong>frac</strong> (<em>float</em><em>, </em><em>optional</em>) – If provided, data will be downsampled to given fraction prior to classification</p></li>
<li><p><strong>downsampling_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – keyword arguments to be passed to density dependent downsampling</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.balance_dataset" title="cytopy.flow.supervised.cell_classifier.CellClassifier.balance_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">balance_dataset</span></code></a>(method, frac, …)</p></td>
<td><p>Given an imbalanced dataset, generate a new dataset with class balance attenuated.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.compare_to_training_set" title="cytopy.flow.supervised.cell_classifier.CellClassifier.compare_to_training_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compare_to_training_set</span></code></a>(sample_id, …)</p></td>
<td><p>Utility function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.gridsearch" title="cytopy.flow.supervised.cell_classifier.CellClassifier.gridsearch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gridsearch</span></code></a>(param_grid, scoring, n_jobs, cv, …)</p></td>
<td><p>Perform Grid-Search for hyper-parameter optimisation using Scikit-Learn GridSearchCV class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.manual_validation" title="cytopy.flow.supervised.cell_classifier.CellClassifier.manual_validation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">manual_validation</span></code></a>(sample_id, …)</p></td>
<td><p>Perform manual validation of the classifier using a sample associated to the same experiment as the training data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.multiclass_labels" title="cytopy.flow.supervised.cell_classifier.CellClassifier.multiclass_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multiclass_labels</span></code></a>(ref, features, root_pop)</p></td>
<td><p>Generate feature space and labels for a multi-label multi-class classification problem and handle the multi-label aspect of this problem by converting multi-label signatures to single labels.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.predict" title="cytopy.flow.supervised.cell_classifier.CellClassifier.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(target_sample, return_gating, …)</p></td>
<td><p>Given a sample ID, predict cell populations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.singleclass_labels" title="cytopy.flow.supervised.cell_classifier.CellClassifier.singleclass_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">singleclass_labels</span></code></a>(ref, features, root_pop)</p></td>
<td><p>Generate feature space and labels where a cell can belong to only one population</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.train" title="cytopy.flow.supervised.cell_classifier.CellClassifier.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a>(**kwargs)</p></td>
<td><p>Train classifier</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.train_cv" title="cytopy.flow.supervised.cell_classifier.CellClassifier.train_cv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_cv</span></code></a>(k, **kwargs)</p></td>
<td><p>Fit classifier to training data using cross-validation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.train_holdout" title="cytopy.flow.supervised.cell_classifier.CellClassifier.train_holdout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_holdout</span></code></a>(holdout_frac, …)</p></td>
<td><p>Fit classifier to training data and evaluate on holdout data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.train_test_split" title="cytopy.flow.supervised.cell_classifier.CellClassifier.train_test_split"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_test_split</span></code></a>(test_size)</p></td>
<td><p>Create train/test split of data using Sklearn’s train_test_split function</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="cytopy.flow.supervised.cell_classifier.CellClassifier.balance_dataset">
<code class="sig-name descname">balance_dataset</code><span class="sig-paren">(</span><em class="sig-param">method: str = 'oversample'</em>, <em class="sig-param">frac: float = 0.5</em>, <em class="sig-param">downsampling_kwargs: dict = None) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.balance_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an imbalanced dataset, generate a new dataset with class balance attenuated. Method can either be
‘oversample’ whereby the RandomOverSampler class of Imbalance Learn is implemented to sample with replacement
in such a way that classes become balanced, or ‘density’ where density dependent downsampling is performed;
see cytopy.flow.gating.utilities.density_dependent_downsampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – Either ‘oversample’ or ‘density’ (default = ‘oversample’
frac: Ignored if method = ‘oversample’. Density dependent downsampling is an absolute sampling technique
that reduces the size of the dataset, this parameter indicates how large the resulting feature space (as a
percentage of the original) should be</p></li>
<li><p><strong>frac</strong> (<em>float</em><em>, </em><em>(</em><em>default=0.5</em><em>)</em>) – If ‘density’ given for method, this is passed as the fraction of data to be sampled</p></li>
<li><p><strong>downsampling_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to call to density_dependent_downsample</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Balanced feature space and labels</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame or (Numpy.array, Numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.cell_classifier.CellClassifier.compare_to_training_set">
<code class="sig-name descname">compare_to_training_set</code><span class="sig-paren">(</span><em class="sig-param">sample_id: str</em>, <em class="sig-param">plot_umap: bool = False</em>, <em class="sig-param">plot_phate: bool = False</em>, <em class="sig-param">root_population: str = None</em>, <em class="sig-param">sample_n: int = 50000</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.compare_to_training_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function. Given some sample ID for a sample associated to experiment, compare the outcome to
the training data; outcome given as a labelled scatter plot, with classified single cell data shown as
components following some dimensionality reduction procedure (default = PCA).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_id</strong> (<em>str</em>) – Name of sample to classify and compare to training data</p></li>
<li><p><strong>plot_umap</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, plot UMAP instead of PCA</p></li>
<li><p><strong>plot_phate</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, plot PHATE instead of PCA</p></li>
<li><p><strong>root_population</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of root population. If none given, use same population as training data</p></li>
<li><p><strong>sample_n</strong> (<em>int</em><em>, </em><em>(</em><em>default=50000</em><em>)</em>) – Number of cells to sample prior to dimensionality reduction procedure</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.cell_classifier.CellClassifier.gridsearch">
<code class="sig-name descname">gridsearch</code><span class="sig-paren">(</span><em class="sig-param">param_grid: dict</em>, <em class="sig-param">scoring: str = 'f1_weighted'</em>, <em class="sig-param">n_jobs: int = -1</em>, <em class="sig-param">cv: int = 5</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.gridsearch" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform Grid-Search for hyper-parameter optimisation using Scikit-Learn GridSearchCV class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_grid</strong> (<em>dict</em><em> or </em><em>list</em>) – (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a>)</p></li>
<li><p><strong>scoring</strong> (<em>str</em><em>, </em><em>(</em><em>default='f1_weighted'</em><em>)</em>) – Scaring function to use</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em>, </em><em>(</em><em>default=-1</em><em>)</em>) – Number of jobs to run in parallel (-1 will use all available cores)</p></li>
<li><p><strong>cv</strong> (<em>int</em><em>, </em><em>(</em><em>default=5</em><em>)</em>) – Number of folds for cross-validation</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments to be passed to GridSearchCV</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>GridSearchCV</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.cell_classifier.CellClassifier.manual_validation">
<code class="sig-name descname">manual_validation</code><span class="sig-paren">(</span><em class="sig-param">sample_id: str</em>, <em class="sig-param">print_report_card: bool = False</em>, <em class="sig-param">root_population: str = None</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.manual_validation" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform manual validation of the classifier using a sample associated to the same experiment as the
training data. Important: the sample given MUST be pre-gated with the same populations as the training dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_population</strong> (<em>str</em><em>, </em><em>(</em><em>optional</em><em>)</em>) – Name of root population. If none given, defaults to root population used in training.</p></li>
<li><p><strong>sample_id</strong> (<em>str</em>) – sample ID for file group to classify</p></li>
<li><p><strong>print_report_card</strong> (<em>bool</em>) – If True, detailed classification report printed to stdout</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame of classification performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.cell_classifier.CellClassifier.multiclass_labels">
<code class="sig-name descname">multiclass_labels</code><span class="sig-paren">(</span><em class="sig-param">ref: cytopy.flow.gating.actions.Gating</em>, <em class="sig-param">features: list</em>, <em class="sig-param">root_pop: str) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em>, <em class="sig-param">&lt;class 'dict'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.multiclass_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate feature space and labels for a multi-label multi-class classification problem and handle the
multi-label aspect of this problem by converting multi-label signatures to single labels. This can be important
if there are correlations between labels e.g. the classification CD3+/- and CD4+/- are not independent because
a cell that is CD4+, CD3- will have a very different meaning to a cell that is CD4+ CD3+. The problem is
converted to a multi class, single label classification by converting each unique one-hot encoded representation
to a ‘fake label’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref</strong> (<a class="reference internal" href="cytopy.flow.gating.actions.html#cytopy.flow.gating.actions.Gating" title="cytopy.flow.gating.actions.Gating"><em>Gating</em></a>) – Gating object to retrieve data from</p></li>
<li><p><strong>features</strong> (<em>list</em>) – list of features for training</p></li>
<li><p><strong>root_pop</strong> (<em>str</em>) – name of the root population</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame of feature space, array of target labels, and a dictionary of cell population mappings</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.cell_classifier.CellClassifier.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">target_sample: str</em>, <em class="sig-param">return_gating: bool = True</em>, <em class="sig-param">root_population: str = None</em><span class="sig-paren">)</span> &#x2192; cytopy.flow.gating.actions.Gating<a class="headerlink" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a sample ID, predict cell populations. Model must already be trained. Results are saved as new
populations in a Gating object returned to the user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_sample</strong> (<em>str</em>) – Name of file for prediction. Must belong to experiment associated to CellClassifier obj.</p></li>
<li><p><strong>return_gating</strong> (<em>bool</em><em>, </em><em>(</em><em>default=True</em><em>)</em>) – If True, returns the modified Gating object with predicted populations contained within</p></li>
<li><p><strong>root_population</strong> (<em>str</em>) – Name of root population</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gating object containing new predicted populations or tuple of (predicted probabilities, predicted labels)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="cytopy.flow.gating.actions.html#cytopy.flow.gating.actions.Gating" title="cytopy.flow.gating.actions.Gating">Gating</a> or (Numpy.array, Numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.cell_classifier.CellClassifier.singleclass_labels">
<code class="sig-name descname">singleclass_labels</code><span class="sig-paren">(</span><em class="sig-param">ref: cytopy.flow.gating.actions.Gating</em>, <em class="sig-param">features: list</em>, <em class="sig-param">root_pop: str) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em>, <em class="sig-param">&lt;class 'dict'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.singleclass_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate feature space and labels where a cell can belong to only one population</p>
<dl class="simple">
<dt>ref: Gating</dt><dd><p>Gating object to retrieve data from</p>
</dd>
<dt>features: list</dt><dd><p>list of features for training</p>
</dd>
<dt>root_pop: str</dt><dd><p>name of the root population</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>DataFrame of feature space, array of target labels, mappings of cell population labels</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(Pandas.DataFrame, Numpy.array, dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.cell_classifier.CellClassifier.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train classifier</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Additional keyword arguments to be passed to call to MODEL.train()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.cell_classifier.CellClassifier.train_cv">
<code class="sig-name descname">train_cv</code><span class="sig-paren">(</span><em class="sig-param">k: int = 5</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.train_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit classifier to training data using cross-validation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>int</em><em>, </em><em>(</em><em>default=5</em><em>)</em>) – Number of folds for cross-validation (default = 5)</p></li>
<li><p><strong>kwargs</strong> – Optional additional kwargs for model fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame detailing performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.cell_classifier.CellClassifier.train_holdout">
<code class="sig-name descname">train_holdout</code><span class="sig-paren">(</span><em class="sig-param">holdout_frac: float = 0.3</em>, <em class="sig-param">print_report_card: bool = False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.train_holdout" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit classifier to training data and evaluate on holdout data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>holdout_frac</strong> (<em>float</em><em>, </em><em>(</em><em>default=0.3</em><em>)</em>) – Proportion of data to keep as holdout</p></li>
<li><p><strong>print_report_card</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, detailed classification report printed to stdout</p></li>
<li><p><strong>kwargs</strong> – Optional additional kwargs for model fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame detailing performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.cell_classifier.CellClassifier.train_test_split">
<code class="sig-name descname">train_test_split</code><span class="sig-paren">(</span><em class="sig-param">test_size: float = 0.3</em><span class="sig-paren">)</span> &#x2192; list<a class="headerlink" href="#cytopy.flow.supervised.cell_classifier.CellClassifier.train_test_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Create train/test split of data using Sklearn’s train_test_split function
(<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>test_size</strong> (<em>float</em>) – size of test population as a proportion of the the dataset (default = 0.3)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List containing train-test split of inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="cytopy.flow.supervised.cell_classifier.create_reference_sample">
<code class="sig-prename descclassname">cytopy.flow.supervised.cell_classifier.</code><code class="sig-name descname">create_reference_sample</code><span class="sig-paren">(</span><em class="sig-param">experiment: cytopy.data.fcs_experiments.FCSExperiment</em>, <em class="sig-param">root_population='root'</em>, <em class="sig-param">samples: list = None</em>, <em class="sig-param">new_file_name: str = None</em>, <em class="sig-param">sampling_method: str = 'uniform'</em>, <em class="sig-param">sample_n: int = 1000</em>, <em class="sig-param">include_population_labels: bool = False</em>, <em class="sig-param">verbose: bool = True</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#cytopy.flow.supervised.cell_classifier.create_reference_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Given some experiment and a root population that is common to all fcs file groups within this experiment, take
a sample from each and create a new file group from the concatenation of these data. New file group will be created
and associated to the given FileExperiment object.
If no file name is given it will default to ‘{Experiment Name}_sampled_data’</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment</strong> (<a class="reference internal" href="cytopy.data.fcs_experiments.html#cytopy.data.fcs_experiments.FCSExperiment" title="cytopy.data.fcs_experiments.FCSExperiment"><em>FCSExperiment</em></a>) – FCSExperiment object for corresponding experiment to sample</p></li>
<li><p><strong>root_population</strong> (<em>str</em>) – if the files in this experiment have already been gated, you can specify to sample
from a particular population e.g. Live CD3+ cells or Live CD45- cells</p></li>
<li><p><strong>samples</strong> (<em>list</em><em>, </em><em>optional</em>) – list of sample IDs for samples to be included (default = all samples in experiment)</p></li>
<li><p><strong>new_file_name</strong> (<em>str</em>) – name of file group generated</p></li>
<li><p><strong>sampling_method</strong> (<em>str</em><em>, </em><em>(</em><em>default='uniform'</em><em>)</em>) – method to use for sampling files (currently only supports ‘uniform’)</p></li>
<li><p><strong>sample_n</strong> (<em>int</em><em>, </em><em>(</em><em>default=1000</em><em>)</em>) – number or fraction of events to sample from each file</p></li>
<li><p><strong>include_population_labels</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, populations in the new file generated are inferred from the existing samples</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>(</em><em>default=True</em><em>)</em>) – Whether to provide feedback</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="cytopy.flow.supervised.cell_classifier.multi_process_ordered">
<code class="sig-prename descclassname">cytopy.flow.supervised.cell_classifier.</code><code class="sig-name descname">multi_process_ordered</code><span class="sig-paren">(</span><em class="sig-param">func: callable</em>, <em class="sig-param">x: iter</em>, <em class="sig-param">chunksize: int = 100</em><span class="sig-paren">)</span> &#x2192; list<a class="headerlink" href="#cytopy.flow.supervised.cell_classifier.multi_process_ordered" title="Permalink to this definition">¶</a></dt>
<dd><p>Map a function (func) to some iterable (x) using multiprocessing. Iterable will be divided into chunks
of size <cite>chunksize</cite>. The chunks will be given as a list of tuples, where the first value is the index of
the chunk and the second value the chunk itself; this allows for ordered reassembly once processing has
completed. For this reason, the function <cite>func</cite> MUST handle and return the index of the chunk upon which
it acts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>callable</em>) – callable function to applied in parallel</p></li>
<li><p><strong>x</strong> (<em>iterable</em>) – some iterable to apply the function to</p></li>
<li><p><strong>chunksize</strong> (<em>int</em><em>, </em><em>(</em><em>default=100</em><em>)</em>) – size of chunks for multiprocessing</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ordered list of funciton output</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-cytopy.flow.supervised.deep_gating"></span><p><strong>Classes</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.DeepGating" title="cytopy.flow.supervised.deep_gating.DeepGating"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DeepGating</span></code></a>(hidden_layer_sizes, n_layers, …)</p></td>
<td><p>Identify populations using a supervised multi-layer feed-forward neural network, inspired by the work of Li, H et al (<a class="reference external" href="https://doi.org/10.1093/bioinformatics/btx448">https://doi.org/10.1093/bioinformatics/btx448</a>).</p></td>
</tr>
</tbody>
</table>
<p><strong>Functions</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.step_decay" title="cytopy.flow.supervised.deep_gating.step_decay"><code class="xref py py-obj docutils literal notranslate"><span class="pre">step_decay</span></code></a>(epoch)</p></td>
<td><p>Learning rate scheduler.</p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="cytopy.flow.supervised.deep_gating.DeepGating">
<em class="property">class </em><code class="sig-prename descclassname">cytopy.flow.supervised.deep_gating.</code><code class="sig-name descname">DeepGating</code><span class="sig-paren">(</span><em class="sig-param">hidden_layer_sizes: list = None</em>, <em class="sig-param">n_layers: int = 3</em>, <em class="sig-param">l2_penalty: float = 0.0001</em>, <em class="sig-param">activation_func: str = 'softplus'</em>, <em class="sig-param">loss_func: str = 'sparse_categorical_crossentropy'</em>, <em class="sig-param">output_activation_func: str = 'softmax'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.deep_gating.DeepGating" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier" title="cytopy.flow.supervised.cell_classifier.CellClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">cytopy.flow.supervised.cell_classifier.CellClassifier</span></code></a></p>
<p>Identify populations using a supervised multi-layer feed-forward neural network, inspired by the work
of Li, H et al (<a class="reference external" href="https://doi.org/10.1093/bioinformatics/btx448">https://doi.org/10.1093/bioinformatics/btx448</a>). Neural network is implemented using Keras
and Tensorflow</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_layer_sizes</strong> (<em>List</em>) – Size of hidden layers (length must equal number of layers)</p></li>
<li><p><strong>n_layer</strong> (<em>int</em><em>, </em><em>(</em><em>default=3</em><em>)</em>) – Number of layers in neural network</p></li>
<li><p><strong>l2_penalty</strong> (<em>float</em><em>, </em><em>(</em><em>default=1e-4</em><em>)</em>) – Parameter for L2 regularisation</p></li>
<li><p><strong>activation_func</strong> (<em>str</em><em>, </em><em>(</em><em>default='softplus'</em><em>)</em>) – Name of activation function to use of hidden layers</p></li>
<li><p><strong>loss_func</strong> (<em>str</em><em>, </em><em>(</em><em>default='sparse_categorical_crossentropy'</em><em>)</em>) – Name of loss function to use for updating weights</p></li>
<li><p><strong>output_activation_func</strong> (<em>str</em><em>, </em><em>(</em><em>default='softmax'</em><em>)</em>) – Name of activation function to use on outer layer</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments for CellClassifier</p></li>
</ul>
</dd>
</dl>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.DeepGating.balance_dataset" title="cytopy.flow.supervised.deep_gating.DeepGating.balance_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">balance_dataset</span></code></a>(method, frac, …)</p></td>
<td><p>Given an imbalanced dataset, generate a new dataset with class balance attenuated.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.DeepGating.build_model" title="cytopy.flow.supervised.deep_gating.DeepGating.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>()</p></td>
<td><p>Build model (must be called prior to fit)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.DeepGating.compare_to_training_set" title="cytopy.flow.supervised.deep_gating.DeepGating.compare_to_training_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compare_to_training_set</span></code></a>(sample_id, …)</p></td>
<td><p>Utility function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.DeepGating.gridsearch" title="cytopy.flow.supervised.deep_gating.DeepGating.gridsearch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gridsearch</span></code></a>(param_grid, scoring, n_jobs, cv, …)</p></td>
<td><p>Perform Grid-Search for hyper-parameter optimisation using Scikit-Learn GridSearchCV class.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.DeepGating.load_model" title="cytopy.flow.supervised.deep_gating.DeepGating.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a>(path)</p></td>
<td><p>Load existing model</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.DeepGating.manual_validation" title="cytopy.flow.supervised.deep_gating.DeepGating.manual_validation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">manual_validation</span></code></a>(sample_id, …)</p></td>
<td><p>Perform manual validation of the classifier using a sample associated to the same experiment as the training data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.DeepGating.multiclass_labels" title="cytopy.flow.supervised.deep_gating.DeepGating.multiclass_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multiclass_labels</span></code></a>(ref, features, root_pop)</p></td>
<td><p>Generate feature space and labels for a multi-label multi-class classification problem and handle the multi-label aspect of this problem by converting multi-label signatures to single labels.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.DeepGating.predict" title="cytopy.flow.supervised.deep_gating.DeepGating.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(target_sample, return_gating, …)</p></td>
<td><p>Given a sample ID, predict cell populations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.DeepGating.save_classifier" title="cytopy.flow.supervised.deep_gating.DeepGating.save_classifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_classifier</span></code></a>(path)</p></td>
<td><p>Save classifier to disk</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.DeepGating.singleclass_labels" title="cytopy.flow.supervised.deep_gating.DeepGating.singleclass_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">singleclass_labels</span></code></a>(ref, features, root_pop)</p></td>
<td><p>Generate feature space and labels where a cell can belong to only one population</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.DeepGating.train" title="cytopy.flow.supervised.deep_gating.DeepGating.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a>(**kwargs)</p></td>
<td><p>Train classifier</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.DeepGating.train_cv" title="cytopy.flow.supervised.deep_gating.DeepGating.train_cv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_cv</span></code></a>(k, **kwargs)</p></td>
<td><p>Fit classifier to training data using cross-validation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.DeepGating.train_holdout" title="cytopy.flow.supervised.deep_gating.DeepGating.train_holdout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_holdout</span></code></a>(holdout_frac, …)</p></td>
<td><p>Fit classifier to training data and evaluate on holdout data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.deep_gating.DeepGating.train_test_split" title="cytopy.flow.supervised.deep_gating.DeepGating.train_test_split"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_test_split</span></code></a>(test_size)</p></td>
<td><p>Create train/test split of data using Sklearn’s train_test_split function</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="cytopy.flow.supervised.deep_gating.DeepGating.balance_dataset">
<code class="sig-name descname">balance_dataset</code><span class="sig-paren">(</span><em class="sig-param">method: str = 'oversample'</em>, <em class="sig-param">frac: float = 0.5</em>, <em class="sig-param">downsampling_kwargs: dict = None) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.deep_gating.DeepGating.balance_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an imbalanced dataset, generate a new dataset with class balance attenuated. Method can either be
‘oversample’ whereby the RandomOverSampler class of Imbalance Learn is implemented to sample with replacement
in such a way that classes become balanced, or ‘density’ where density dependent downsampling is performed;
see cytopy.flow.gating.utilities.density_dependent_downsampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – Either ‘oversample’ or ‘density’ (default = ‘oversample’
frac: Ignored if method = ‘oversample’. Density dependent downsampling is an absolute sampling technique
that reduces the size of the dataset, this parameter indicates how large the resulting feature space (as a
percentage of the original) should be</p></li>
<li><p><strong>frac</strong> (<em>float</em><em>, </em><em>(</em><em>default=0.5</em><em>)</em>) – If ‘density’ given for method, this is passed as the fraction of data to be sampled</p></li>
<li><p><strong>downsampling_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to call to density_dependent_downsample</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Balanced feature space and labels</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame or (Numpy.array, Numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.deep_gating.DeepGating.build_model">
<code class="sig-name descname">build_model</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.deep_gating.DeepGating.build_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Build model (must be called prior to fit)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.deep_gating.DeepGating.compare_to_training_set">
<code class="sig-name descname">compare_to_training_set</code><span class="sig-paren">(</span><em class="sig-param">sample_id: str</em>, <em class="sig-param">plot_umap: bool = False</em>, <em class="sig-param">plot_phate: bool = False</em>, <em class="sig-param">root_population: str = None</em>, <em class="sig-param">sample_n: int = 50000</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.deep_gating.DeepGating.compare_to_training_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function. Given some sample ID for a sample associated to experiment, compare the outcome to
the training data; outcome given as a labelled scatter plot, with classified single cell data shown as
components following some dimensionality reduction procedure (default = PCA).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_id</strong> (<em>str</em>) – Name of sample to classify and compare to training data</p></li>
<li><p><strong>plot_umap</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, plot UMAP instead of PCA</p></li>
<li><p><strong>plot_phate</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, plot PHATE instead of PCA</p></li>
<li><p><strong>root_population</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of root population. If none given, use same population as training data</p></li>
<li><p><strong>sample_n</strong> (<em>int</em><em>, </em><em>(</em><em>default=50000</em><em>)</em>) – Number of cells to sample prior to dimensionality reduction procedure</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.deep_gating.DeepGating.gridsearch">
<code class="sig-name descname">gridsearch</code><span class="sig-paren">(</span><em class="sig-param">param_grid: dict</em>, <em class="sig-param">scoring: str = 'f1_weighted'</em>, <em class="sig-param">n_jobs: int = -1</em>, <em class="sig-param">cv: int = 5</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.deep_gating.DeepGating.gridsearch" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform Grid-Search for hyper-parameter optimisation using Scikit-Learn GridSearchCV class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_grid</strong> (<em>dict</em><em> or </em><em>list</em>) – (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a>)</p></li>
<li><p><strong>scoring</strong> (<em>str</em><em>, </em><em>(</em><em>default='f1_weighted'</em><em>)</em>) – Scaring function to use</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em>, </em><em>(</em><em>default=-1</em><em>)</em>) – Number of jobs to run in parallel (-1 will use all available cores)</p></li>
<li><p><strong>cv</strong> (<em>int</em><em>, </em><em>(</em><em>default=5</em><em>)</em>) – Number of folds for cross-validation</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments to be passed to GridSearchCV</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>GridSearchCV</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.deep_gating.DeepGating.load_model">
<code class="sig-name descname">load_model</code><span class="sig-paren">(</span><em class="sig-param">path: str</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.deep_gating.DeepGating.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load existing model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Path to existing Kera model</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.deep_gating.DeepGating.manual_validation">
<code class="sig-name descname">manual_validation</code><span class="sig-paren">(</span><em class="sig-param">sample_id: str</em>, <em class="sig-param">print_report_card: bool = False</em>, <em class="sig-param">root_population: str = None</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.deep_gating.DeepGating.manual_validation" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform manual validation of the classifier using a sample associated to the same experiment as the
training data. Important: the sample given MUST be pre-gated with the same populations as the training dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_population</strong> (<em>str</em><em>, </em><em>(</em><em>optional</em><em>)</em>) – Name of root population. If none given, defaults to root population used in training.</p></li>
<li><p><strong>sample_id</strong> (<em>str</em>) – sample ID for file group to classify</p></li>
<li><p><strong>print_report_card</strong> (<em>bool</em>) – If True, detailed classification report printed to stdout</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame of classification performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.deep_gating.DeepGating.multiclass_labels">
<code class="sig-name descname">multiclass_labels</code><span class="sig-paren">(</span><em class="sig-param">ref: cytopy.flow.gating.actions.Gating</em>, <em class="sig-param">features: list</em>, <em class="sig-param">root_pop: str) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em>, <em class="sig-param">&lt;class 'dict'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.deep_gating.DeepGating.multiclass_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate feature space and labels for a multi-label multi-class classification problem and handle the
multi-label aspect of this problem by converting multi-label signatures to single labels. This can be important
if there are correlations between labels e.g. the classification CD3+/- and CD4+/- are not independent because
a cell that is CD4+, CD3- will have a very different meaning to a cell that is CD4+ CD3+. The problem is
converted to a multi class, single label classification by converting each unique one-hot encoded representation
to a ‘fake label’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref</strong> (<a class="reference internal" href="cytopy.flow.gating.actions.html#cytopy.flow.gating.actions.Gating" title="cytopy.flow.gating.actions.Gating"><em>Gating</em></a>) – Gating object to retrieve data from</p></li>
<li><p><strong>features</strong> (<em>list</em>) – list of features for training</p></li>
<li><p><strong>root_pop</strong> (<em>str</em>) – name of the root population</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame of feature space, array of target labels, and a dictionary of cell population mappings</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.deep_gating.DeepGating.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">target_sample: str</em>, <em class="sig-param">return_gating: bool = True</em>, <em class="sig-param">root_population: str = None</em><span class="sig-paren">)</span> &#x2192; cytopy.flow.gating.actions.Gating<a class="headerlink" href="#cytopy.flow.supervised.deep_gating.DeepGating.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a sample ID, predict cell populations. Model must already be trained. Results are saved as new
populations in a Gating object returned to the user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_sample</strong> (<em>str</em>) – Name of file for prediction. Must belong to experiment associated to CellClassifier obj.</p></li>
<li><p><strong>return_gating</strong> (<em>bool</em><em>, </em><em>(</em><em>default=True</em><em>)</em>) – If True, returns the modified Gating object with predicted populations contained within</p></li>
<li><p><strong>root_population</strong> (<em>str</em>) – Name of root population</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gating object containing new predicted populations or tuple of (predicted probabilities, predicted labels)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="cytopy.flow.gating.actions.html#cytopy.flow.gating.actions.Gating" title="cytopy.flow.gating.actions.Gating">Gating</a> or (Numpy.array, Numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.deep_gating.DeepGating.save_classifier">
<code class="sig-name descname">save_classifier</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.deep_gating.DeepGating.save_classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Save classifier to disk</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – File path</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.deep_gating.DeepGating.singleclass_labels">
<code class="sig-name descname">singleclass_labels</code><span class="sig-paren">(</span><em class="sig-param">ref: cytopy.flow.gating.actions.Gating</em>, <em class="sig-param">features: list</em>, <em class="sig-param">root_pop: str) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em>, <em class="sig-param">&lt;class 'dict'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.deep_gating.DeepGating.singleclass_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate feature space and labels where a cell can belong to only one population</p>
<dl class="simple">
<dt>ref: Gating</dt><dd><p>Gating object to retrieve data from</p>
</dd>
<dt>features: list</dt><dd><p>list of features for training</p>
</dd>
<dt>root_pop: str</dt><dd><p>name of the root population</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>DataFrame of feature space, array of target labels, mappings of cell population labels</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(Pandas.DataFrame, Numpy.array, dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.deep_gating.DeepGating.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.deep_gating.DeepGating.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train classifier</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Additional keyword arguments to be passed to call to MODEL.train()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.deep_gating.DeepGating.train_cv">
<code class="sig-name descname">train_cv</code><span class="sig-paren">(</span><em class="sig-param">k: int = 5</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.deep_gating.DeepGating.train_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit classifier to training data using cross-validation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>int</em><em>, </em><em>(</em><em>default=5</em><em>)</em>) – Number of folds for cross-validation (default = 5)</p></li>
<li><p><strong>kwargs</strong> – Optional additional kwargs for model fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame detailing performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.deep_gating.DeepGating.train_holdout">
<code class="sig-name descname">train_holdout</code><span class="sig-paren">(</span><em class="sig-param">holdout_frac: float = 0.3</em>, <em class="sig-param">print_report_card: bool = False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.deep_gating.DeepGating.train_holdout" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit classifier to training data and evaluate on holdout data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>holdout_frac</strong> (<em>float</em><em>, </em><em>(</em><em>default=0.3</em><em>)</em>) – Proportion of data to keep as holdout</p></li>
<li><p><strong>print_report_card</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, detailed classification report printed to stdout</p></li>
<li><p><strong>kwargs</strong> – Optional additional kwargs for model fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame detailing performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.deep_gating.DeepGating.train_test_split">
<code class="sig-name descname">train_test_split</code><span class="sig-paren">(</span><em class="sig-param">test_size: float = 0.3</em><span class="sig-paren">)</span> &#x2192; list<a class="headerlink" href="#cytopy.flow.supervised.deep_gating.DeepGating.train_test_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Create train/test split of data using Sklearn’s train_test_split function
(<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>test_size</strong> (<em>float</em>) – size of test population as a proportion of the the dataset (default = 0.3)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List containing train-test split of inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="cytopy.flow.supervised.deep_gating.step_decay">
<code class="sig-prename descclassname">cytopy.flow.supervised.deep_gating.</code><code class="sig-name descname">step_decay</code><span class="sig-paren">(</span><em class="sig-param">epoch: int</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.deep_gating.step_decay" title="Permalink to this definition">¶</a></dt>
<dd><p>Learning rate scheduler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>epoch</strong> (<em>int</em>) – Number of epochs to perform</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Learning rate</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-cytopy.flow.supervised.discriminant_analysis"></span><p><strong>Classes</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis" title="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DiscriminantAnalysis</span></code></a>(**kwargs)</p></td>
<td><p>Implement a discriminant analysis classifier for the purpose of predicting cell classification in</p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis">
<em class="property">class </em><code class="sig-prename descclassname">cytopy.flow.supervised.discriminant_analysis.</code><code class="sig-name descname">DiscriminantAnalysis</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier" title="cytopy.flow.supervised.cell_classifier.CellClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">cytopy.flow.supervised.cell_classifier.CellClassifier</span></code></a></p>
<p>Implement a discriminant analysis classifier for the purpose of predicting cell classification in
cytometry data</p>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.balance_dataset" title="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.balance_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">balance_dataset</span></code></a>(method, frac, …)</p></td>
<td><p>Given an imbalanced dataset, generate a new dataset with class balance attenuated.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.build_linear" title="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.build_linear"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_linear</span></code></a>(**kwargs)</p></td>
<td><p>Build LDA model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.build_quadratic" title="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.build_quadratic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_quadratic</span></code></a>(**kwargs)</p></td>
<td><p>Build QDA model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.compare_to_training_set" title="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.compare_to_training_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compare_to_training_set</span></code></a>(sample_id, …)</p></td>
<td><p>Utility function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.gridsearch" title="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.gridsearch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gridsearch</span></code></a>(param_grid, scoring, n_jobs, cv, …)</p></td>
<td><p>Perform Grid-Search for hyper-parameter optimisation using Scikit-Learn GridSearchCV class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.manual_validation" title="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.manual_validation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">manual_validation</span></code></a>(sample_id, …)</p></td>
<td><p>Perform manual validation of the classifier using a sample associated to the same experiment as the training data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.multiclass_labels" title="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.multiclass_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multiclass_labels</span></code></a>(ref, features, root_pop)</p></td>
<td><p>Generate feature space and labels for a multi-label multi-class classification problem and handle the multi-label aspect of this problem by converting multi-label signatures to single labels.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.predict" title="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(target_sample, return_gating, …)</p></td>
<td><p>Given a sample ID, predict cell populations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.singleclass_labels" title="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.singleclass_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">singleclass_labels</span></code></a>(ref, features, root_pop)</p></td>
<td><p>Generate feature space and labels where a cell can belong to only one population</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train" title="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a>(**kwargs)</p></td>
<td><p>Train classifier</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train_cv" title="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train_cv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_cv</span></code></a>(k, **kwargs)</p></td>
<td><p>Fit classifier to training data using cross-validation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train_holdout" title="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train_holdout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_holdout</span></code></a>(holdout_frac, …)</p></td>
<td><p>Fit classifier to training data and evaluate on holdout data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train_test_split" title="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train_test_split"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_test_split</span></code></a>(test_size)</p></td>
<td><p>Create train/test split of data using Sklearn’s train_test_split function</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.balance_dataset">
<code class="sig-name descname">balance_dataset</code><span class="sig-paren">(</span><em class="sig-param">method: str = 'oversample'</em>, <em class="sig-param">frac: float = 0.5</em>, <em class="sig-param">downsampling_kwargs: dict = None) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.balance_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an imbalanced dataset, generate a new dataset with class balance attenuated. Method can either be
‘oversample’ whereby the RandomOverSampler class of Imbalance Learn is implemented to sample with replacement
in such a way that classes become balanced, or ‘density’ where density dependent downsampling is performed;
see cytopy.flow.gating.utilities.density_dependent_downsampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – Either ‘oversample’ or ‘density’ (default = ‘oversample’
frac: Ignored if method = ‘oversample’. Density dependent downsampling is an absolute sampling technique
that reduces the size of the dataset, this parameter indicates how large the resulting feature space (as a
percentage of the original) should be</p></li>
<li><p><strong>frac</strong> (<em>float</em><em>, </em><em>(</em><em>default=0.5</em><em>)</em>) – If ‘density’ given for method, this is passed as the fraction of data to be sampled</p></li>
<li><p><strong>downsampling_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to call to density_dependent_downsample</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Balanced feature space and labels</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame or (Numpy.array, Numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.build_linear">
<code class="sig-name descname">build_linear</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.build_linear" title="Permalink to this definition">¶</a></dt>
<dd><p>Build LDA model. Implements Scikit-Learn’s  Linear Discriminant Analysis classifier, see
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.discriminant_analysis.LinearDiscriminantAnalysis.html">https://scikit-learn.org/stable/modules/generated/sklearn.discriminant_analysis.LinearDiscriminantAnalysis.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – additional keyword arguments for LinearDiscriminantAnalysis (see sklearn documentation)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.build_quadratic">
<code class="sig-name descname">build_quadratic</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.build_quadratic" title="Permalink to this definition">¶</a></dt>
<dd><p>Build QDA model. Implements Scikit-Learn’s  Quadratic Discriminant Analysis classifier, see
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.discriminant_analysis.QuadraticDiscriminantAnalysis.html">https://scikit-learn.org/stable/modules/generated/sklearn.discriminant_analysis.QuadraticDiscriminantAnalysis.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – additional keyword arguments for QuadraticDiscriminantAnalysis (see sklearn documentation)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.compare_to_training_set">
<code class="sig-name descname">compare_to_training_set</code><span class="sig-paren">(</span><em class="sig-param">sample_id: str</em>, <em class="sig-param">plot_umap: bool = False</em>, <em class="sig-param">plot_phate: bool = False</em>, <em class="sig-param">root_population: str = None</em>, <em class="sig-param">sample_n: int = 50000</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.compare_to_training_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function. Given some sample ID for a sample associated to experiment, compare the outcome to
the training data; outcome given as a labelled scatter plot, with classified single cell data shown as
components following some dimensionality reduction procedure (default = PCA).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_id</strong> (<em>str</em>) – Name of sample to classify and compare to training data</p></li>
<li><p><strong>plot_umap</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, plot UMAP instead of PCA</p></li>
<li><p><strong>plot_phate</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, plot PHATE instead of PCA</p></li>
<li><p><strong>root_population</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of root population. If none given, use same population as training data</p></li>
<li><p><strong>sample_n</strong> (<em>int</em><em>, </em><em>(</em><em>default=50000</em><em>)</em>) – Number of cells to sample prior to dimensionality reduction procedure</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.gridsearch">
<code class="sig-name descname">gridsearch</code><span class="sig-paren">(</span><em class="sig-param">param_grid: dict</em>, <em class="sig-param">scoring: str = 'f1_weighted'</em>, <em class="sig-param">n_jobs: int = -1</em>, <em class="sig-param">cv: int = 5</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.gridsearch" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform Grid-Search for hyper-parameter optimisation using Scikit-Learn GridSearchCV class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_grid</strong> (<em>dict</em><em> or </em><em>list</em>) – (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a>)</p></li>
<li><p><strong>scoring</strong> (<em>str</em><em>, </em><em>(</em><em>default='f1_weighted'</em><em>)</em>) – Scaring function to use</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em>, </em><em>(</em><em>default=-1</em><em>)</em>) – Number of jobs to run in parallel (-1 will use all available cores)</p></li>
<li><p><strong>cv</strong> (<em>int</em><em>, </em><em>(</em><em>default=5</em><em>)</em>) – Number of folds for cross-validation</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments to be passed to GridSearchCV</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>GridSearchCV</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.manual_validation">
<code class="sig-name descname">manual_validation</code><span class="sig-paren">(</span><em class="sig-param">sample_id: str</em>, <em class="sig-param">print_report_card: bool = False</em>, <em class="sig-param">root_population: str = None</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.manual_validation" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform manual validation of the classifier using a sample associated to the same experiment as the
training data. Important: the sample given MUST be pre-gated with the same populations as the training dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_population</strong> (<em>str</em><em>, </em><em>(</em><em>optional</em><em>)</em>) – Name of root population. If none given, defaults to root population used in training.</p></li>
<li><p><strong>sample_id</strong> (<em>str</em>) – sample ID for file group to classify</p></li>
<li><p><strong>print_report_card</strong> (<em>bool</em>) – If True, detailed classification report printed to stdout</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame of classification performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.multiclass_labels">
<code class="sig-name descname">multiclass_labels</code><span class="sig-paren">(</span><em class="sig-param">ref: cytopy.flow.gating.actions.Gating</em>, <em class="sig-param">features: list</em>, <em class="sig-param">root_pop: str) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em>, <em class="sig-param">&lt;class 'dict'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.multiclass_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate feature space and labels for a multi-label multi-class classification problem and handle the
multi-label aspect of this problem by converting multi-label signatures to single labels. This can be important
if there are correlations between labels e.g. the classification CD3+/- and CD4+/- are not independent because
a cell that is CD4+, CD3- will have a very different meaning to a cell that is CD4+ CD3+. The problem is
converted to a multi class, single label classification by converting each unique one-hot encoded representation
to a ‘fake label’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref</strong> (<a class="reference internal" href="cytopy.flow.gating.actions.html#cytopy.flow.gating.actions.Gating" title="cytopy.flow.gating.actions.Gating"><em>Gating</em></a>) – Gating object to retrieve data from</p></li>
<li><p><strong>features</strong> (<em>list</em>) – list of features for training</p></li>
<li><p><strong>root_pop</strong> (<em>str</em>) – name of the root population</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame of feature space, array of target labels, and a dictionary of cell population mappings</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">target_sample: str</em>, <em class="sig-param">return_gating: bool = True</em>, <em class="sig-param">root_population: str = None</em><span class="sig-paren">)</span> &#x2192; cytopy.flow.gating.actions.Gating<a class="headerlink" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a sample ID, predict cell populations. Model must already be trained. Results are saved as new
populations in a Gating object returned to the user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_sample</strong> (<em>str</em>) – Name of file for prediction. Must belong to experiment associated to CellClassifier obj.</p></li>
<li><p><strong>return_gating</strong> (<em>bool</em><em>, </em><em>(</em><em>default=True</em><em>)</em>) – If True, returns the modified Gating object with predicted populations contained within</p></li>
<li><p><strong>root_population</strong> (<em>str</em>) – Name of root population</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gating object containing new predicted populations or tuple of (predicted probabilities, predicted labels)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="cytopy.flow.gating.actions.html#cytopy.flow.gating.actions.Gating" title="cytopy.flow.gating.actions.Gating">Gating</a> or (Numpy.array, Numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.singleclass_labels">
<code class="sig-name descname">singleclass_labels</code><span class="sig-paren">(</span><em class="sig-param">ref: cytopy.flow.gating.actions.Gating</em>, <em class="sig-param">features: list</em>, <em class="sig-param">root_pop: str) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em>, <em class="sig-param">&lt;class 'dict'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.singleclass_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate feature space and labels where a cell can belong to only one population</p>
<dl class="simple">
<dt>ref: Gating</dt><dd><p>Gating object to retrieve data from</p>
</dd>
<dt>features: list</dt><dd><p>list of features for training</p>
</dd>
<dt>root_pop: str</dt><dd><p>name of the root population</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>DataFrame of feature space, array of target labels, mappings of cell population labels</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(Pandas.DataFrame, Numpy.array, dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train classifier</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Additional keyword arguments to be passed to call to MODEL.train()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train_cv">
<code class="sig-name descname">train_cv</code><span class="sig-paren">(</span><em class="sig-param">k: int = 5</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit classifier to training data using cross-validation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>int</em><em>, </em><em>(</em><em>default=5</em><em>)</em>) – Number of folds for cross-validation (default = 5)</p></li>
<li><p><strong>kwargs</strong> – Optional additional kwargs for model fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame detailing performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train_holdout">
<code class="sig-name descname">train_holdout</code><span class="sig-paren">(</span><em class="sig-param">holdout_frac: float = 0.3</em>, <em class="sig-param">print_report_card: bool = False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train_holdout" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit classifier to training data and evaluate on holdout data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>holdout_frac</strong> (<em>float</em><em>, </em><em>(</em><em>default=0.3</em><em>)</em>) – Proportion of data to keep as holdout</p></li>
<li><p><strong>print_report_card</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, detailed classification report printed to stdout</p></li>
<li><p><strong>kwargs</strong> – Optional additional kwargs for model fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame detailing performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train_test_split">
<code class="sig-name descname">train_test_split</code><span class="sig-paren">(</span><em class="sig-param">test_size: float = 0.3</em><span class="sig-paren">)</span> &#x2192; list<a class="headerlink" href="#cytopy.flow.supervised.discriminant_analysis.DiscriminantAnalysis.train_test_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Create train/test split of data using Sklearn’s train_test_split function
(<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>test_size</strong> (<em>float</em>) – size of test population as a proportion of the the dataset (default = 0.3)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List containing train-test split of inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-cytopy.flow.supervised.evaluate"></span><p><strong>Functions</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.evaluate.evaluate_model" title="cytopy.flow.supervised.evaluate.evaluate_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate_model</span></code></a>(classifier, x, y, threshold)</p></td>
<td><p>Calculate performance of a given classifier, returning a DataFrame summarising the performance.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.evaluate.multi_label_performance" title="cytopy.flow.supervised.evaluate.multi_label_performance"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multi_label_performance</span></code></a>(y, y_probs)</p></td>
<td><p>Calculate ranking average precision and label ranking loss for a multi-label classifier</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.evaluate.plot_cm" title="cytopy.flow.supervised.evaluate.plot_cm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_cm</span></code></a>(classifier, x, y, normalize, **kwargs)</p></td>
<td><p>Generate a confusion matrix plot using</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.evaluate.report_card" title="cytopy.flow.supervised.evaluate.report_card"><code class="xref py py-obj docutils literal notranslate"><span class="pre">report_card</span></code></a>(classifier, x, y, mappings, …)</p></td>
<td><p>Generate a ‘report card’; details everything the ‘evaluate_model’ function does, but includes performance</p></td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="cytopy.flow.supervised.evaluate.evaluate_model">
<code class="sig-prename descclassname">cytopy.flow.supervised.evaluate.</code><code class="sig-name descname">evaluate_model</code><span class="sig-paren">(</span><em class="sig-param">classifier</em>, <em class="sig-param">x: numpy.array</em>, <em class="sig-param">y: numpy.array</em>, <em class="sig-param">threshold: float = None</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.evaluate.evaluate_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate performance of a given classifier, returning a DataFrame summarising the performance.
Metrics include: weighted F1-score, balanced accuracy, precision, and recall</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classifier</strong> (<a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier" title="cytopy.flow.supervised.cell_classifier.CellClassifier"><em>CellClassifier</em></a>) – </p></li>
<li><p><strong>x</strong> (<em>Numpy.array</em>) – Feature space</p></li>
<li><p><strong>y</strong> (<em>Numpy.array</em>) – Labels</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="cytopy.flow.supervised.evaluate.multi_label_performance">
<code class="sig-prename descclassname">cytopy.flow.supervised.evaluate.</code><code class="sig-name descname">multi_label_performance</code><span class="sig-paren">(</span><em class="sig-param">y: numpy.array</em>, <em class="sig-param">y_probs: numpy.array</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.evaluate.multi_label_performance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate ranking average precision and label ranking loss for a multi-label classifier</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>Numpy.array</em>) – predicted labels</p></li>
<li><p><strong>y_probs</strong> (<em>Numpy.array</em>) – predicted probabilities</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="cytopy.flow.supervised.evaluate.plot_cm">
<code class="sig-prename descclassname">cytopy.flow.supervised.evaluate.</code><code class="sig-name descname">plot_cm</code><span class="sig-paren">(</span><em class="sig-param">classifier</em>, <em class="sig-param">x: numpy.array</em>, <em class="sig-param">y: numpy.array</em>, <em class="sig-param">normalize: bool = True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.evaluate.plot_cm" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a confusion matrix plot using
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.plot_confusion_matrix.html">https://scikit-learn.org/stable/modules/generated/sklearn.metrics.plot_confusion_matrix.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classifier</strong> (<a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier" title="cytopy.flow.supervised.cell_classifier.CellClassifier"><em>CellClassifier</em></a>) – </p></li>
<li><p><strong>x</strong> (<em>Numpy.array</em>) – Feature space</p></li>
<li><p><strong>y</strong> (<em>Numpy.array</em>) – Labels</p></li>
<li><p><strong>normalize</strong> (<em>bool</em><em>, </em><em>(</em><em>default=True</em><em>)</em>) – If True, values are normalised over the true values</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments to be passed to plot_confusion_matrix call</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Matplotlib.Figure</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="cytopy.flow.supervised.evaluate.report_card">
<code class="sig-prename descclassname">cytopy.flow.supervised.evaluate.</code><code class="sig-name descname">report_card</code><span class="sig-paren">(</span><em class="sig-param">classifier</em>, <em class="sig-param">x: numpy.array</em>, <em class="sig-param">y: numpy.array</em>, <em class="sig-param">mappings: dict = None</em>, <em class="sig-param">threshold: float = None</em>, <em class="sig-param">sample_weights: dict = None</em>, <em class="sig-param">include_confusion_matrix: bool = True</em>, <em class="sig-param">include_accuracies: bool = True</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.evaluate.report_card" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a ‘report card’; details everything the ‘evaluate_model’ function does, but includes performance
breakdown for each class and gives the option to plot a confusion matrix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>classifier</strong> (<a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier" title="cytopy.flow.supervised.cell_classifier.CellClassifier"><em>CellClassifier</em></a>) – </p></li>
<li><p><strong>x</strong> (<em>Numpy.array</em>) – Feature space</p></li>
<li><p><strong>y</strong> (<em>Numpy.array</em>) – Labels</p></li>
<li><p><strong>mappings</strong> (<em>dict</em><em>, </em><em>optional</em>) – Class mappings; if provided they act as a key for the plotted confusion matrix</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold to pass to evaluate_model</p></li>
<li><p><strong>sample_weights</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of sample weights; include if you wish for this to be accounted when calculating performance</p></li>
<li><p><strong>include_confusion_matrix</strong> (<em>bool</em><em>, </em><em>(</em><em>default=True</em><em>)</em>) – If True, plots a confusion matrix</p></li>
<li><p><strong>include_accuracies</strong> (<em>bool</em><em>, </em><em>(</em><em>default=True</em><em>)</em>) – If True, includes a per-class accuracy calculation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Results printed to stdout</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-cytopy.flow.supervised.knn"></span><p><strong>Classes</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.knn.KNN" title="cytopy.flow.supervised.knn.KNN"><code class="xref py py-obj docutils literal notranslate"><span class="pre">KNN</span></code></a>(**kwargs)</p></td>
<td><p>Implement a K Nearest Neighbours classifier for the purpose of predicting cell classification in cytometry data</p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="cytopy.flow.supervised.knn.KNN">
<em class="property">class </em><code class="sig-prename descclassname">cytopy.flow.supervised.knn.</code><code class="sig-name descname">KNN</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.knn.KNN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier" title="cytopy.flow.supervised.cell_classifier.CellClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">cytopy.flow.supervised.cell_classifier.CellClassifier</span></code></a></p>
<p>Implement a K Nearest Neighbours classifier for the purpose of predicting cell classification in cytometry data</p>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.knn.KNN.balance_dataset" title="cytopy.flow.supervised.knn.KNN.balance_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">balance_dataset</span></code></a>(method, frac, …)</p></td>
<td><p>Given an imbalanced dataset, generate a new dataset with class balance attenuated.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.knn.KNN.build_model" title="cytopy.flow.supervised.knn.KNN.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>(**kwargs)</p></td>
<td><p>Build KNN model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.knn.KNN.compare_to_training_set" title="cytopy.flow.supervised.knn.KNN.compare_to_training_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compare_to_training_set</span></code></a>(sample_id, …)</p></td>
<td><p>Utility function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.knn.KNN.gridsearch" title="cytopy.flow.supervised.knn.KNN.gridsearch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gridsearch</span></code></a>(param_grid, scoring, n_jobs, cv, …)</p></td>
<td><p>Perform Grid-Search for hyper-parameter optimisation using Scikit-Learn GridSearchCV class.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.knn.KNN.manual_validation" title="cytopy.flow.supervised.knn.KNN.manual_validation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">manual_validation</span></code></a>(sample_id, …)</p></td>
<td><p>Perform manual validation of the classifier using a sample associated to the same experiment as the training data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.knn.KNN.multiclass_labels" title="cytopy.flow.supervised.knn.KNN.multiclass_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multiclass_labels</span></code></a>(ref, features, root_pop)</p></td>
<td><p>Generate feature space and labels for a multi-label multi-class classification problem and handle the multi-label aspect of this problem by converting multi-label signatures to single labels.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.knn.KNN.predict" title="cytopy.flow.supervised.knn.KNN.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(target_sample, return_gating, …)</p></td>
<td><p>Given a sample ID, predict cell populations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.knn.KNN.singleclass_labels" title="cytopy.flow.supervised.knn.KNN.singleclass_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">singleclass_labels</span></code></a>(ref, features, root_pop)</p></td>
<td><p>Generate feature space and labels where a cell can belong to only one population</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.knn.KNN.train" title="cytopy.flow.supervised.knn.KNN.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a>(**kwargs)</p></td>
<td><p>Train classifier</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.knn.KNN.train_cv" title="cytopy.flow.supervised.knn.KNN.train_cv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_cv</span></code></a>(k, **kwargs)</p></td>
<td><p>Fit classifier to training data using cross-validation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.knn.KNN.train_holdout" title="cytopy.flow.supervised.knn.KNN.train_holdout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_holdout</span></code></a>(holdout_frac, …)</p></td>
<td><p>Fit classifier to training data and evaluate on holdout data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.knn.KNN.train_test_split" title="cytopy.flow.supervised.knn.KNN.train_test_split"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_test_split</span></code></a>(test_size)</p></td>
<td><p>Create train/test split of data using Sklearn’s train_test_split function</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="cytopy.flow.supervised.knn.KNN.balance_dataset">
<code class="sig-name descname">balance_dataset</code><span class="sig-paren">(</span><em class="sig-param">method: str = 'oversample'</em>, <em class="sig-param">frac: float = 0.5</em>, <em class="sig-param">downsampling_kwargs: dict = None) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.knn.KNN.balance_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an imbalanced dataset, generate a new dataset with class balance attenuated. Method can either be
‘oversample’ whereby the RandomOverSampler class of Imbalance Learn is implemented to sample with replacement
in such a way that classes become balanced, or ‘density’ where density dependent downsampling is performed;
see cytopy.flow.gating.utilities.density_dependent_downsampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – Either ‘oversample’ or ‘density’ (default = ‘oversample’
frac: Ignored if method = ‘oversample’. Density dependent downsampling is an absolute sampling technique
that reduces the size of the dataset, this parameter indicates how large the resulting feature space (as a
percentage of the original) should be</p></li>
<li><p><strong>frac</strong> (<em>float</em><em>, </em><em>(</em><em>default=0.5</em><em>)</em>) – If ‘density’ given for method, this is passed as the fraction of data to be sampled</p></li>
<li><p><strong>downsampling_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to call to density_dependent_downsample</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Balanced feature space and labels</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame or (Numpy.array, Numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.knn.KNN.build_model">
<code class="sig-name descname">build_model</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#cytopy.flow.supervised.knn.KNN.build_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Build KNN model. Implements Scikit-Learn’s  k-nearest neighbors classifier, see
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html">https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – additional keyword arguments for KNeighborsClassifier (see sklearn documentation)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.knn.KNN.compare_to_training_set">
<code class="sig-name descname">compare_to_training_set</code><span class="sig-paren">(</span><em class="sig-param">sample_id: str</em>, <em class="sig-param">plot_umap: bool = False</em>, <em class="sig-param">plot_phate: bool = False</em>, <em class="sig-param">root_population: str = None</em>, <em class="sig-param">sample_n: int = 50000</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.knn.KNN.compare_to_training_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function. Given some sample ID for a sample associated to experiment, compare the outcome to
the training data; outcome given as a labelled scatter plot, with classified single cell data shown as
components following some dimensionality reduction procedure (default = PCA).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_id</strong> (<em>str</em>) – Name of sample to classify and compare to training data</p></li>
<li><p><strong>plot_umap</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, plot UMAP instead of PCA</p></li>
<li><p><strong>plot_phate</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, plot PHATE instead of PCA</p></li>
<li><p><strong>root_population</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of root population. If none given, use same population as training data</p></li>
<li><p><strong>sample_n</strong> (<em>int</em><em>, </em><em>(</em><em>default=50000</em><em>)</em>) – Number of cells to sample prior to dimensionality reduction procedure</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.knn.KNN.gridsearch">
<code class="sig-name descname">gridsearch</code><span class="sig-paren">(</span><em class="sig-param">param_grid: dict</em>, <em class="sig-param">scoring: str = 'f1_weighted'</em>, <em class="sig-param">n_jobs: int = -1</em>, <em class="sig-param">cv: int = 5</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.knn.KNN.gridsearch" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform Grid-Search for hyper-parameter optimisation using Scikit-Learn GridSearchCV class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_grid</strong> (<em>dict</em><em> or </em><em>list</em>) – (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a>)</p></li>
<li><p><strong>scoring</strong> (<em>str</em><em>, </em><em>(</em><em>default='f1_weighted'</em><em>)</em>) – Scaring function to use</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em>, </em><em>(</em><em>default=-1</em><em>)</em>) – Number of jobs to run in parallel (-1 will use all available cores)</p></li>
<li><p><strong>cv</strong> (<em>int</em><em>, </em><em>(</em><em>default=5</em><em>)</em>) – Number of folds for cross-validation</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments to be passed to GridSearchCV</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>GridSearchCV</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.knn.KNN.manual_validation">
<code class="sig-name descname">manual_validation</code><span class="sig-paren">(</span><em class="sig-param">sample_id: str</em>, <em class="sig-param">print_report_card: bool = False</em>, <em class="sig-param">root_population: str = None</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.knn.KNN.manual_validation" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform manual validation of the classifier using a sample associated to the same experiment as the
training data. Important: the sample given MUST be pre-gated with the same populations as the training dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_population</strong> (<em>str</em><em>, </em><em>(</em><em>optional</em><em>)</em>) – Name of root population. If none given, defaults to root population used in training.</p></li>
<li><p><strong>sample_id</strong> (<em>str</em>) – sample ID for file group to classify</p></li>
<li><p><strong>print_report_card</strong> (<em>bool</em>) – If True, detailed classification report printed to stdout</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame of classification performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.knn.KNN.multiclass_labels">
<code class="sig-name descname">multiclass_labels</code><span class="sig-paren">(</span><em class="sig-param">ref: cytopy.flow.gating.actions.Gating</em>, <em class="sig-param">features: list</em>, <em class="sig-param">root_pop: str) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em>, <em class="sig-param">&lt;class 'dict'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.knn.KNN.multiclass_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate feature space and labels for a multi-label multi-class classification problem and handle the
multi-label aspect of this problem by converting multi-label signatures to single labels. This can be important
if there are correlations between labels e.g. the classification CD3+/- and CD4+/- are not independent because
a cell that is CD4+, CD3- will have a very different meaning to a cell that is CD4+ CD3+. The problem is
converted to a multi class, single label classification by converting each unique one-hot encoded representation
to a ‘fake label’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref</strong> (<a class="reference internal" href="cytopy.flow.gating.actions.html#cytopy.flow.gating.actions.Gating" title="cytopy.flow.gating.actions.Gating"><em>Gating</em></a>) – Gating object to retrieve data from</p></li>
<li><p><strong>features</strong> (<em>list</em>) – list of features for training</p></li>
<li><p><strong>root_pop</strong> (<em>str</em>) – name of the root population</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame of feature space, array of target labels, and a dictionary of cell population mappings</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.knn.KNN.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">target_sample: str</em>, <em class="sig-param">return_gating: bool = True</em>, <em class="sig-param">root_population: str = None</em><span class="sig-paren">)</span> &#x2192; cytopy.flow.gating.actions.Gating<a class="headerlink" href="#cytopy.flow.supervised.knn.KNN.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a sample ID, predict cell populations. Model must already be trained. Results are saved as new
populations in a Gating object returned to the user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_sample</strong> (<em>str</em>) – Name of file for prediction. Must belong to experiment associated to CellClassifier obj.</p></li>
<li><p><strong>return_gating</strong> (<em>bool</em><em>, </em><em>(</em><em>default=True</em><em>)</em>) – If True, returns the modified Gating object with predicted populations contained within</p></li>
<li><p><strong>root_population</strong> (<em>str</em>) – Name of root population</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gating object containing new predicted populations or tuple of (predicted probabilities, predicted labels)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="cytopy.flow.gating.actions.html#cytopy.flow.gating.actions.Gating" title="cytopy.flow.gating.actions.Gating">Gating</a> or (Numpy.array, Numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.knn.KNN.singleclass_labels">
<code class="sig-name descname">singleclass_labels</code><span class="sig-paren">(</span><em class="sig-param">ref: cytopy.flow.gating.actions.Gating</em>, <em class="sig-param">features: list</em>, <em class="sig-param">root_pop: str) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em>, <em class="sig-param">&lt;class 'dict'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.knn.KNN.singleclass_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate feature space and labels where a cell can belong to only one population</p>
<dl class="simple">
<dt>ref: Gating</dt><dd><p>Gating object to retrieve data from</p>
</dd>
<dt>features: list</dt><dd><p>list of features for training</p>
</dd>
<dt>root_pop: str</dt><dd><p>name of the root population</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>DataFrame of feature space, array of target labels, mappings of cell population labels</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(Pandas.DataFrame, Numpy.array, dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.knn.KNN.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.knn.KNN.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train classifier</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Additional keyword arguments to be passed to call to MODEL.train()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.knn.KNN.train_cv">
<code class="sig-name descname">train_cv</code><span class="sig-paren">(</span><em class="sig-param">k: int = 5</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.knn.KNN.train_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit classifier to training data using cross-validation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>int</em><em>, </em><em>(</em><em>default=5</em><em>)</em>) – Number of folds for cross-validation (default = 5)</p></li>
<li><p><strong>kwargs</strong> – Optional additional kwargs for model fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame detailing performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.knn.KNN.train_holdout">
<code class="sig-name descname">train_holdout</code><span class="sig-paren">(</span><em class="sig-param">holdout_frac: float = 0.3</em>, <em class="sig-param">print_report_card: bool = False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.knn.KNN.train_holdout" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit classifier to training data and evaluate on holdout data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>holdout_frac</strong> (<em>float</em><em>, </em><em>(</em><em>default=0.3</em><em>)</em>) – Proportion of data to keep as holdout</p></li>
<li><p><strong>print_report_card</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, detailed classification report printed to stdout</p></li>
<li><p><strong>kwargs</strong> – Optional additional kwargs for model fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame detailing performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.knn.KNN.train_test_split">
<code class="sig-name descname">train_test_split</code><span class="sig-paren">(</span><em class="sig-param">test_size: float = 0.3</em><span class="sig-paren">)</span> &#x2192; list<a class="headerlink" href="#cytopy.flow.supervised.knn.KNN.train_test_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Create train/test split of data using Sklearn’s train_test_split function
(<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>test_size</strong> (<em>float</em>) – size of test population as a proportion of the the dataset (default = 0.3)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List containing train-test split of inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-cytopy.flow.supervised.ref"></span><p><strong>Functions</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.ref.calculate_ref_sample_fast" title="cytopy.flow.supervised.ref.calculate_ref_sample_fast"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_ref_sample_fast</span></code></a>(experiment, …)</p></td>
<td><p>Given an FCS Experiment with multiple FCS files, calculate the optimal reference file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.ref.calculate_reference_sample" title="cytopy.flow.supervised.ref.calculate_reference_sample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calculate_reference_sample</span></code></a>(experiment, …)</p></td>
<td><p>Given an FCS Experiment with multiple FCS files, calculate the optimal reference file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.ref.pull_data" title="cytopy.flow.supervised.ref.pull_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pull_data</span></code></a>(sid, experiment, features, …)</p></td>
<td><p>Given a sample ID and experiment that the sample belongs too, fetch a DataFrame of associated single cell data including the given features and (if provided) down-sample the data to the value of sample_n.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.ref.pull_data_hashtable" title="cytopy.flow.supervised.ref.pull_data_hashtable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pull_data_hashtable</span></code></a>(sid, experiment, …)</p></td>
<td><p>Wrapper for pull_data that returns sample data as a dictionary where the key is the sample ID</p></td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="cytopy.flow.supervised.ref.calculate_ref_sample_fast">
<code class="sig-prename descclassname">cytopy.flow.supervised.ref.</code><code class="sig-name descname">calculate_ref_sample_fast</code><span class="sig-paren">(</span><em class="sig-param">experiment: cytopy.data.fcs_experiments.FCSExperiment</em>, <em class="sig-param">exclude_samples: list = None</em>, <em class="sig-param">sample_n: int = 1000</em>, <em class="sig-param">verbose: bool = True</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.ref.calculate_ref_sample_fast" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an FCS Experiment with multiple FCS files, calculate the optimal reference file.</p>
<p>This is performed as described in Li et al paper (<a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5860171/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5860171/</a>) on
DeepCyTOF: for every 2 samples i, j compute the Frobenius norm of the difference between their covariance matrics
and then select the sample with the smallest average distance to all other samples.</p>
<p>This is an optimised version of supervised.ref.calculate_red_sample that leverages the multi-processing library
to speed up operations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment</strong> (<a class="reference internal" href="cytopy.data.fcs_experiments.html#cytopy.data.fcs_experiments.FCSExperiment" title="cytopy.data.fcs_experiments.FCSExperiment"><em>FCSExperiment</em></a>) – Experiment to find reference sample for</p></li>
<li><p><strong>exclude_samples</strong> (<em>list</em><em>, </em><em>optional</em>) – If given, any samples in list will be excluded</p></li>
<li><p><strong>sample_n</strong> (<em>int</em><em>, </em><em>(</em><em>default=1000</em><em>)</em>) – Data is downsampled prior to running algorithm, this specifies how many observations to sample from each</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>(</em><em>default=True</em><em>)</em>) – Feedback</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Sample ID of reference sample</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="cytopy.flow.supervised.ref.calculate_reference_sample">
<code class="sig-prename descclassname">cytopy.flow.supervised.ref.</code><code class="sig-name descname">calculate_reference_sample</code><span class="sig-paren">(</span><em class="sig-param">experiment: cytopy.data.fcs_experiments.FCSExperiment</em>, <em class="sig-param">exclude_samples: list</em><span class="sig-paren">)</span> &#x2192; str<a class="headerlink" href="#cytopy.flow.supervised.ref.calculate_reference_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an FCS Experiment with multiple FCS files, calculate the optimal reference file.</p>
<p>This is performed as described in Li et al paper (<a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5860171/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5860171/</a>) on
DeepCyTOF: for every 2 samples i, j compute the Frobenius norm of the difference between their covariance matrics
and then select the sample with the smallest average distance to all other samples.</p>
<p>This is an optimised version of supervised.ref.calculate_red_sample that leverages the multi-processing library
to speed up operations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment</strong> (<a class="reference internal" href="cytopy.data.fcs_experiments.html#cytopy.data.fcs_experiments.FCSExperiment" title="cytopy.data.fcs_experiments.FCSExperiment"><em>FCSExperiment</em></a>) – Experiment to find reference sample for</p></li>
<li><p><strong>exclude_samples</strong> (<em>list</em><em>, </em><em>optional</em>) – If given, any samples in list will be excluded</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Sample ID of reference sample</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="cytopy.flow.supervised.ref.pull_data">
<code class="sig-prename descclassname">cytopy.flow.supervised.ref.</code><code class="sig-name descname">pull_data</code><span class="sig-paren">(</span><em class="sig-param">sid: str</em>, <em class="sig-param">experiment: cytopy.data.fcs_experiments.FCSExperiment</em>, <em class="sig-param">features: list</em>, <em class="sig-param">sample_n: int = None</em>, <em class="sig-param">transform: str = 'logicle'</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.ref.pull_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a sample ID and experiment that the sample belongs too, fetch a DataFrame of associated single cell
data including the given features and (if provided) down-sample the data to the value of sample_n.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sid</strong> (<em>str</em>) – Sample ID</p></li>
<li><p><strong>experiment</strong> (<a class="reference internal" href="cytopy.data.fcs_experiments.html#cytopy.data.fcs_experiments.FCSExperiment" title="cytopy.data.fcs_experiments.FCSExperiment"><em>FCSExperiment</em></a>) – Experiment to retrieve data from</p></li>
<li><p><strong>features</strong> (<em>list</em>) – List of valid features (variables measured e.g. CD4 or FSC-A)</p></li>
<li><p><strong>sample_n</strong> (<em>int</em><em>, </em><em>optional</em>) – If given, data is down-sampled to the given value</p></li>
<li><p><strong>transform</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>(</em><em>default='logicle'</em><em>)</em>) – If given, data is transformed according to given method, see flow.transforms</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="cytopy.flow.supervised.ref.pull_data_hashtable">
<code class="sig-prename descclassname">cytopy.flow.supervised.ref.</code><code class="sig-name descname">pull_data_hashtable</code><span class="sig-paren">(</span><em class="sig-param">sid: str</em>, <em class="sig-param">experiment: cytopy.data.fcs_experiments.FCSExperiment</em>, <em class="sig-param">features: list</em>, <em class="sig-param">sample_n: int</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.ref.pull_data_hashtable" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for pull_data that returns sample data as a dictionary where the key is the sample ID
and the value is the sample DataFrame</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sid</strong> (<em>str</em>) – Sample ID for data retrieval</p></li>
<li><p><strong>experiment</strong> (<a class="reference internal" href="cytopy.data.fcs_experiments.html#cytopy.data.fcs_experiments.FCSExperiment" title="cytopy.data.fcs_experiments.FCSExperiment"><em>FCSExperiment</em></a>) – Experiment for data retrieval</p></li>
<li><p><strong>features</strong> (<em>list</em>) – List of features to retrieve</p></li>
<li><p><strong>sample_n</strong> (<em>int</em>) – Total number of events to sample</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>{sample ID: Pandas.DataFrame}</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-cytopy.flow.supervised.svm"></span><p><strong>Classes</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.svm.SupportVectorMachine" title="cytopy.flow.supervised.svm.SupportVectorMachine"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SupportVectorMachine</span></code></a>(**kwargs)</p></td>
<td><p>Implement a Support Vector Machine for the purpose of predicting cell classification in cytometry data</p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="cytopy.flow.supervised.svm.SupportVectorMachine">
<em class="property">class </em><code class="sig-prename descclassname">cytopy.flow.supervised.svm.</code><code class="sig-name descname">SupportVectorMachine</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.svm.SupportVectorMachine" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier" title="cytopy.flow.supervised.cell_classifier.CellClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">cytopy.flow.supervised.cell_classifier.CellClassifier</span></code></a></p>
<p>Implement a Support Vector Machine for the purpose of predicting cell classification in cytometry data</p>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.svm.SupportVectorMachine.balance_dataset" title="cytopy.flow.supervised.svm.SupportVectorMachine.balance_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">balance_dataset</span></code></a>(method, frac, …)</p></td>
<td><p>Given an imbalanced dataset, generate a new dataset with class balance attenuated.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.svm.SupportVectorMachine.build_linear" title="cytopy.flow.supervised.svm.SupportVectorMachine.build_linear"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_linear</span></code></a>(**kwargs)</p></td>
<td><p>Build linear SVM.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.svm.SupportVectorMachine.build_nonlinear" title="cytopy.flow.supervised.svm.SupportVectorMachine.build_nonlinear"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_nonlinear</span></code></a>(kernel, cache_size, **kwargs)</p></td>
<td><p>Build non-linear SVM.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.svm.SupportVectorMachine.compare_to_training_set" title="cytopy.flow.supervised.svm.SupportVectorMachine.compare_to_training_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compare_to_training_set</span></code></a>(sample_id, …)</p></td>
<td><p>Utility function.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.svm.SupportVectorMachine.gridsearch" title="cytopy.flow.supervised.svm.SupportVectorMachine.gridsearch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gridsearch</span></code></a>(param_grid, scoring, n_jobs, cv, …)</p></td>
<td><p>Perform Grid-Search for hyper-parameter optimisation using Scikit-Learn GridSearchCV class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.svm.SupportVectorMachine.manual_validation" title="cytopy.flow.supervised.svm.SupportVectorMachine.manual_validation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">manual_validation</span></code></a>(sample_id, …)</p></td>
<td><p>Perform manual validation of the classifier using a sample associated to the same experiment as the training data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.svm.SupportVectorMachine.multiclass_labels" title="cytopy.flow.supervised.svm.SupportVectorMachine.multiclass_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multiclass_labels</span></code></a>(ref, features, root_pop)</p></td>
<td><p>Generate feature space and labels for a multi-label multi-class classification problem and handle the multi-label aspect of this problem by converting multi-label signatures to single labels.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.svm.SupportVectorMachine.predict" title="cytopy.flow.supervised.svm.SupportVectorMachine.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(target_sample, return_gating, …)</p></td>
<td><p>Given a sample ID, predict cell populations.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.svm.SupportVectorMachine.singleclass_labels" title="cytopy.flow.supervised.svm.SupportVectorMachine.singleclass_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">singleclass_labels</span></code></a>(ref, features, root_pop)</p></td>
<td><p>Generate feature space and labels where a cell can belong to only one population</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.svm.SupportVectorMachine.train" title="cytopy.flow.supervised.svm.SupportVectorMachine.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a>(**kwargs)</p></td>
<td><p>Train classifier</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.svm.SupportVectorMachine.train_cv" title="cytopy.flow.supervised.svm.SupportVectorMachine.train_cv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_cv</span></code></a>(k, **kwargs)</p></td>
<td><p>Fit classifier to training data using cross-validation</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.svm.SupportVectorMachine.train_holdout" title="cytopy.flow.supervised.svm.SupportVectorMachine.train_holdout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_holdout</span></code></a>(holdout_frac, …)</p></td>
<td><p>Fit classifier to training data and evaluate on holdout data.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.svm.SupportVectorMachine.train_test_split" title="cytopy.flow.supervised.svm.SupportVectorMachine.train_test_split"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_test_split</span></code></a>(test_size)</p></td>
<td><p>Create train/test split of data using Sklearn’s train_test_split function</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="cytopy.flow.supervised.svm.SupportVectorMachine.balance_dataset">
<code class="sig-name descname">balance_dataset</code><span class="sig-paren">(</span><em class="sig-param">method: str = 'oversample'</em>, <em class="sig-param">frac: float = 0.5</em>, <em class="sig-param">downsampling_kwargs: dict = None) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.svm.SupportVectorMachine.balance_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an imbalanced dataset, generate a new dataset with class balance attenuated. Method can either be
‘oversample’ whereby the RandomOverSampler class of Imbalance Learn is implemented to sample with replacement
in such a way that classes become balanced, or ‘density’ where density dependent downsampling is performed;
see cytopy.flow.gating.utilities.density_dependent_downsampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – Either ‘oversample’ or ‘density’ (default = ‘oversample’
frac: Ignored if method = ‘oversample’. Density dependent downsampling is an absolute sampling technique
that reduces the size of the dataset, this parameter indicates how large the resulting feature space (as a
percentage of the original) should be</p></li>
<li><p><strong>frac</strong> (<em>float</em><em>, </em><em>(</em><em>default=0.5</em><em>)</em>) – If ‘density’ given for method, this is passed as the fraction of data to be sampled</p></li>
<li><p><strong>downsampling_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to call to density_dependent_downsample</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Balanced feature space and labels</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame or (Numpy.array, Numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.svm.SupportVectorMachine.build_linear">
<code class="sig-name descname">build_linear</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#cytopy.flow.supervised.svm.SupportVectorMachine.build_linear" title="Permalink to this definition">¶</a></dt>
<dd><p>Build linear SVM. Implements Scikit-Learn’s Linear Support Vector Classification, see
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVC.html">https://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVC.html</a>
Implements a one-verus-rest strategy for handling multi-class classificaiton.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<em>additional keyword arguments for LinearSVC</em><em> (</em><em>see sklearn documentation</em><em>)</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.svm.SupportVectorMachine.build_nonlinear">
<code class="sig-name descname">build_nonlinear</code><span class="sig-paren">(</span><em class="sig-param">kernel: str = 'poly'</em>, <em class="sig-param">cache_size: float = 4000</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#cytopy.flow.supervised.svm.SupportVectorMachine.build_nonlinear" title="Permalink to this definition">¶</a></dt>
<dd><p>Build non-linear SVM. Implements Scikit-Learn’s C-Support Vector Classification, see
<a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html">http://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html</a>
Implements one-versus-rest strategy for handling multi-class classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kernel</strong> (<em>str</em><em> or </em><em>callable</em><em>, </em><em>(</em><em>defauly='poly'</em><em>)</em>) – kernel type to be used by the algorithm, must be one of ‘linear’, ‘poly’, ‘rbf’, ‘sigmoid’,
or a function (custom kernel).</p></li>
<li><p><strong>cache_size</strong> (<em>float</em><em>, </em><em>(</em><em>default=4000</em><em>)</em>) – Size of kernel cache (default = 4000 MB)</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for SVC (see sklearn documentation)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.svm.SupportVectorMachine.compare_to_training_set">
<code class="sig-name descname">compare_to_training_set</code><span class="sig-paren">(</span><em class="sig-param">sample_id: str</em>, <em class="sig-param">plot_umap: bool = False</em>, <em class="sig-param">plot_phate: bool = False</em>, <em class="sig-param">root_population: str = None</em>, <em class="sig-param">sample_n: int = 50000</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.svm.SupportVectorMachine.compare_to_training_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function. Given some sample ID for a sample associated to experiment, compare the outcome to
the training data; outcome given as a labelled scatter plot, with classified single cell data shown as
components following some dimensionality reduction procedure (default = PCA).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_id</strong> (<em>str</em>) – Name of sample to classify and compare to training data</p></li>
<li><p><strong>plot_umap</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, plot UMAP instead of PCA</p></li>
<li><p><strong>plot_phate</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, plot PHATE instead of PCA</p></li>
<li><p><strong>root_population</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of root population. If none given, use same population as training data</p></li>
<li><p><strong>sample_n</strong> (<em>int</em><em>, </em><em>(</em><em>default=50000</em><em>)</em>) – Number of cells to sample prior to dimensionality reduction procedure</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.svm.SupportVectorMachine.gridsearch">
<code class="sig-name descname">gridsearch</code><span class="sig-paren">(</span><em class="sig-param">param_grid: dict</em>, <em class="sig-param">scoring: str = 'f1_weighted'</em>, <em class="sig-param">n_jobs: int = -1</em>, <em class="sig-param">cv: int = 5</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.svm.SupportVectorMachine.gridsearch" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform Grid-Search for hyper-parameter optimisation using Scikit-Learn GridSearchCV class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_grid</strong> (<em>dict</em><em> or </em><em>list</em>) – (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a>)</p></li>
<li><p><strong>scoring</strong> (<em>str</em><em>, </em><em>(</em><em>default='f1_weighted'</em><em>)</em>) – Scaring function to use</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em>, </em><em>(</em><em>default=-1</em><em>)</em>) – Number of jobs to run in parallel (-1 will use all available cores)</p></li>
<li><p><strong>cv</strong> (<em>int</em><em>, </em><em>(</em><em>default=5</em><em>)</em>) – Number of folds for cross-validation</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments to be passed to GridSearchCV</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>GridSearchCV</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.svm.SupportVectorMachine.manual_validation">
<code class="sig-name descname">manual_validation</code><span class="sig-paren">(</span><em class="sig-param">sample_id: str</em>, <em class="sig-param">print_report_card: bool = False</em>, <em class="sig-param">root_population: str = None</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.svm.SupportVectorMachine.manual_validation" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform manual validation of the classifier using a sample associated to the same experiment as the
training data. Important: the sample given MUST be pre-gated with the same populations as the training dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_population</strong> (<em>str</em><em>, </em><em>(</em><em>optional</em><em>)</em>) – Name of root population. If none given, defaults to root population used in training.</p></li>
<li><p><strong>sample_id</strong> (<em>str</em>) – sample ID for file group to classify</p></li>
<li><p><strong>print_report_card</strong> (<em>bool</em>) – If True, detailed classification report printed to stdout</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame of classification performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.svm.SupportVectorMachine.multiclass_labels">
<code class="sig-name descname">multiclass_labels</code><span class="sig-paren">(</span><em class="sig-param">ref: cytopy.flow.gating.actions.Gating</em>, <em class="sig-param">features: list</em>, <em class="sig-param">root_pop: str) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em>, <em class="sig-param">&lt;class 'dict'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.svm.SupportVectorMachine.multiclass_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate feature space and labels for a multi-label multi-class classification problem and handle the
multi-label aspect of this problem by converting multi-label signatures to single labels. This can be important
if there are correlations between labels e.g. the classification CD3+/- and CD4+/- are not independent because
a cell that is CD4+, CD3- will have a very different meaning to a cell that is CD4+ CD3+. The problem is
converted to a multi class, single label classification by converting each unique one-hot encoded representation
to a ‘fake label’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref</strong> (<a class="reference internal" href="cytopy.flow.gating.actions.html#cytopy.flow.gating.actions.Gating" title="cytopy.flow.gating.actions.Gating"><em>Gating</em></a>) – Gating object to retrieve data from</p></li>
<li><p><strong>features</strong> (<em>list</em>) – list of features for training</p></li>
<li><p><strong>root_pop</strong> (<em>str</em>) – name of the root population</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame of feature space, array of target labels, and a dictionary of cell population mappings</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.svm.SupportVectorMachine.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">target_sample: str</em>, <em class="sig-param">return_gating: bool = True</em>, <em class="sig-param">root_population: str = None</em><span class="sig-paren">)</span> &#x2192; cytopy.flow.gating.actions.Gating<a class="headerlink" href="#cytopy.flow.supervised.svm.SupportVectorMachine.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a sample ID, predict cell populations. Model must already be trained. Results are saved as new
populations in a Gating object returned to the user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_sample</strong> (<em>str</em>) – Name of file for prediction. Must belong to experiment associated to CellClassifier obj.</p></li>
<li><p><strong>return_gating</strong> (<em>bool</em><em>, </em><em>(</em><em>default=True</em><em>)</em>) – If True, returns the modified Gating object with predicted populations contained within</p></li>
<li><p><strong>root_population</strong> (<em>str</em>) – Name of root population</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gating object containing new predicted populations or tuple of (predicted probabilities, predicted labels)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="cytopy.flow.gating.actions.html#cytopy.flow.gating.actions.Gating" title="cytopy.flow.gating.actions.Gating">Gating</a> or (Numpy.array, Numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.svm.SupportVectorMachine.singleclass_labels">
<code class="sig-name descname">singleclass_labels</code><span class="sig-paren">(</span><em class="sig-param">ref: cytopy.flow.gating.actions.Gating</em>, <em class="sig-param">features: list</em>, <em class="sig-param">root_pop: str) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em>, <em class="sig-param">&lt;class 'dict'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.svm.SupportVectorMachine.singleclass_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate feature space and labels where a cell can belong to only one population</p>
<dl class="simple">
<dt>ref: Gating</dt><dd><p>Gating object to retrieve data from</p>
</dd>
<dt>features: list</dt><dd><p>list of features for training</p>
</dd>
<dt>root_pop: str</dt><dd><p>name of the root population</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>DataFrame of feature space, array of target labels, mappings of cell population labels</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(Pandas.DataFrame, Numpy.array, dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.svm.SupportVectorMachine.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.svm.SupportVectorMachine.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train classifier</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Additional keyword arguments to be passed to call to MODEL.train()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.svm.SupportVectorMachine.train_cv">
<code class="sig-name descname">train_cv</code><span class="sig-paren">(</span><em class="sig-param">k: int = 5</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.svm.SupportVectorMachine.train_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit classifier to training data using cross-validation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>int</em><em>, </em><em>(</em><em>default=5</em><em>)</em>) – Number of folds for cross-validation (default = 5)</p></li>
<li><p><strong>kwargs</strong> – Optional additional kwargs for model fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame detailing performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.svm.SupportVectorMachine.train_holdout">
<code class="sig-name descname">train_holdout</code><span class="sig-paren">(</span><em class="sig-param">holdout_frac: float = 0.3</em>, <em class="sig-param">print_report_card: bool = False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.svm.SupportVectorMachine.train_holdout" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit classifier to training data and evaluate on holdout data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>holdout_frac</strong> (<em>float</em><em>, </em><em>(</em><em>default=0.3</em><em>)</em>) – Proportion of data to keep as holdout</p></li>
<li><p><strong>print_report_card</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, detailed classification report printed to stdout</p></li>
<li><p><strong>kwargs</strong> – Optional additional kwargs for model fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame detailing performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.svm.SupportVectorMachine.train_test_split">
<code class="sig-name descname">train_test_split</code><span class="sig-paren">(</span><em class="sig-param">test_size: float = 0.3</em><span class="sig-paren">)</span> &#x2192; list<a class="headerlink" href="#cytopy.flow.supervised.svm.SupportVectorMachine.train_test_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Create train/test split of data using Sklearn’s train_test_split function
(<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>test_size</strong> (<em>float</em>) – size of test population as a proportion of the the dataset (default = 0.3)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List containing train-test split of inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-cytopy.flow.supervised.utilities"></span><p><strong>Functions</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.utilities.find_common_features" title="cytopy.flow.supervised.utilities.find_common_features"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_common_features</span></code></a>(experiment, samples)</p></td>
<td><p>Generate a list of common features present in all given samples of an experiment.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.utilities.predict_class" title="cytopy.flow.supervised.utilities.predict_class"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict_class</span></code></a>(y_probs, threshold)</p></td>
<td><p>Returns the predicted class given the probabilities of each class.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.utilities.random_oversampling" title="cytopy.flow.supervised.utilities.random_oversampling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">random_oversampling</span></code></a>(x, y)</p></td>
<td><p>Wrapper for imblearn.over_sampling.RandomOverSampler</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.utilities.scaler" title="cytopy.flow.supervised.utilities.scaler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scaler</span></code></a>(data, scale_method, **kwargs)</p></td>
<td><p>Wrapper for Sklearn transformation methods</p></td>
</tr>
</tbody>
</table>
<dl class="function">
<dt id="cytopy.flow.supervised.utilities.find_common_features">
<code class="sig-prename descclassname">cytopy.flow.supervised.utilities.</code><code class="sig-name descname">find_common_features</code><span class="sig-paren">(</span><em class="sig-param">experiment: cytopy.data.fcs_experiments.FCSExperiment</em>, <em class="sig-param">samples: list = None</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.utilities.find_common_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a list of common features present in all given samples of an experiment. By ‘feature’ we mean
a variable measured for a particular sample e.g. CD4 or FSC-A (forward scatter)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment</strong> (<a class="reference internal" href="cytopy.data.fcs_experiments.html#cytopy.data.fcs_experiments.FCSExperiment" title="cytopy.data.fcs_experiments.FCSExperiment"><em>FCSExperiment</em></a>) – Experiment to extract features from</p></li>
<li><p><strong>samples</strong> (<em>list</em><em>, </em><em>optional</em>) – List of samples to get common features of. If None, will search all samples in experiment.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="cytopy.flow.supervised.utilities.predict_class">
<code class="sig-prename descclassname">cytopy.flow.supervised.utilities.</code><code class="sig-name descname">predict_class</code><span class="sig-paren">(</span><em class="sig-param">y_probs: numpy.array</em>, <em class="sig-param">threshold: float = None</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.utilities.predict_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the predicted class given the probabilities of each class. If threshold = None, the class with
the highest probability is returned for each value in y, otherwise assumed to be multi-label prediction
and converts output to binarised-encoded multi-label output using the given threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_probs</strong> (<em>Numpy.array</em>) – List of probabilities for predicted labels</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold for positivity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="cytopy.flow.supervised.utilities.random_oversampling">
<code class="sig-prename descclassname">cytopy.flow.supervised.utilities.</code><code class="sig-name descname">random_oversampling</code><span class="sig-paren">(</span><em class="sig-param">x: numpy.array</em>, <em class="sig-param">y: numpy.array</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.utilities.random_oversampling" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for imblearn.over_sampling.RandomOverSampler</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>Numpy.array</em>) – Feature space</p></li>
<li><p><strong>y</strong> (<em>Numpy.array</em>) – Labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Re-sampled data with unrepresented classes randomly oversampled</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(Numpy.array, Numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="cytopy.flow.supervised.utilities.scaler">
<code class="sig-prename descclassname">cytopy.flow.supervised.utilities.</code><code class="sig-name descname">scaler</code><span class="sig-paren">(</span><em class="sig-param">data: numpy.array</em>, <em class="sig-param">scale_method: str</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; callable<a class="headerlink" href="#cytopy.flow.supervised.utilities.scaler" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for Sklearn transformation methods</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Numpy.array</em>) – data to transform; expects a numpy array</p></li>
<li><p><strong>scale_method</strong> (<em>str</em>) – type of transformation to perform</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments that can be passed to sklearn function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>transformed data and sklearn transformer object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(Numpy.array, callable)</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-cytopy.flow.supervised.xgboost"></span><p><strong>Classes</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier" title="cytopy.flow.supervised.xgboost.XGBoostClassifier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">XGBoostClassifier</span></code></a>(**kwargs)</p></td>
<td><p>Implement an XGBoost classifier for the purpose of predicting cell classification in cytometry data</p></td>
</tr>
</tbody>
</table>
<dl class="class">
<dt id="cytopy.flow.supervised.xgboost.XGBoostClassifier">
<em class="property">class </em><code class="sig-prename descclassname">cytopy.flow.supervised.xgboost.</code><code class="sig-name descname">XGBoostClassifier</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#cytopy.flow.supervised.cell_classifier.CellClassifier" title="cytopy.flow.supervised.cell_classifier.CellClassifier"><code class="xref py py-class docutils literal notranslate"><span class="pre">cytopy.flow.supervised.cell_classifier.CellClassifier</span></code></a></p>
<p>Implement an XGBoost classifier for the purpose of predicting cell classification in cytometry data</p>
<p><strong>Methods</strong></p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.balance_dataset" title="cytopy.flow.supervised.xgboost.XGBoostClassifier.balance_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">balance_dataset</span></code></a>(method, frac, …)</p></td>
<td><p>Given an imbalanced dataset, generate a new dataset with class balance attenuated.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.build_model" title="cytopy.flow.supervised.xgboost.XGBoostClassifier.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>(**kwargs)</p></td>
<td><p>Build an XGBoost model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.compare_to_training_set" title="cytopy.flow.supervised.xgboost.XGBoostClassifier.compare_to_training_set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compare_to_training_set</span></code></a>(sample_id, …)</p></td>
<td><p>Utility function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.gridsearch" title="cytopy.flow.supervised.xgboost.XGBoostClassifier.gridsearch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gridsearch</span></code></a>(param_grid, scoring, n_jobs, cv, …)</p></td>
<td><p>Perform Grid-Search for hyper-parameter optimisation using Scikit-Learn GridSearchCV class.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.manual_validation" title="cytopy.flow.supervised.xgboost.XGBoostClassifier.manual_validation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">manual_validation</span></code></a>(sample_id, …)</p></td>
<td><p>Perform manual validation of the classifier using a sample associated to the same experiment as the training data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.multiclass_labels" title="cytopy.flow.supervised.xgboost.XGBoostClassifier.multiclass_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multiclass_labels</span></code></a>(ref, features, root_pop)</p></td>
<td><p>Generate feature space and labels for a multi-label multi-class classification problem and handle the multi-label aspect of this problem by converting multi-label signatures to single labels.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.predict" title="cytopy.flow.supervised.xgboost.XGBoostClassifier.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>(target_sample, return_gating, …)</p></td>
<td><p>Given a sample ID, predict cell populations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.singleclass_labels" title="cytopy.flow.supervised.xgboost.XGBoostClassifier.singleclass_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">singleclass_labels</span></code></a>(ref, features, root_pop)</p></td>
<td><p>Generate feature space and labels where a cell can belong to only one population</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.train" title="cytopy.flow.supervised.xgboost.XGBoostClassifier.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a>(**kwargs)</p></td>
<td><p>Train classifier</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.train_cv" title="cytopy.flow.supervised.xgboost.XGBoostClassifier.train_cv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_cv</span></code></a>(k, **kwargs)</p></td>
<td><p>Fit classifier to training data using cross-validation</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.train_holdout" title="cytopy.flow.supervised.xgboost.XGBoostClassifier.train_holdout"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_holdout</span></code></a>(holdout_frac, …)</p></td>
<td><p>Fit classifier to training data and evaluate on holdout data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.train_test_split" title="cytopy.flow.supervised.xgboost.XGBoostClassifier.train_test_split"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_test_split</span></code></a>(test_size)</p></td>
<td><p>Create train/test split of data using Sklearn’s train_test_split function</p></td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="cytopy.flow.supervised.xgboost.XGBoostClassifier.balance_dataset">
<code class="sig-name descname">balance_dataset</code><span class="sig-paren">(</span><em class="sig-param">method: str = 'oversample'</em>, <em class="sig-param">frac: float = 0.5</em>, <em class="sig-param">downsampling_kwargs: dict = None) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.balance_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an imbalanced dataset, generate a new dataset with class balance attenuated. Method can either be
‘oversample’ whereby the RandomOverSampler class of Imbalance Learn is implemented to sample with replacement
in such a way that classes become balanced, or ‘density’ where density dependent downsampling is performed;
see cytopy.flow.gating.utilities.density_dependent_downsampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<em>str</em>) – Either ‘oversample’ or ‘density’ (default = ‘oversample’
frac: Ignored if method = ‘oversample’. Density dependent downsampling is an absolute sampling technique
that reduces the size of the dataset, this parameter indicates how large the resulting feature space (as a
percentage of the original) should be</p></li>
<li><p><strong>frac</strong> (<em>float</em><em>, </em><em>(</em><em>default=0.5</em><em>)</em>) – If ‘density’ given for method, this is passed as the fraction of data to be sampled</p></li>
<li><p><strong>downsampling_kwargs</strong> (<em>dict</em>) – Additional keyword arguments passed to call to density_dependent_downsample</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Balanced feature space and labels</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame or (Numpy.array, Numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.xgboost.XGBoostClassifier.build_model">
<code class="sig-name descname">build_model</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.build_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Build an XGBoost model. Implements XGBoost classifier using the Sklearn wrapper, see
<a class="reference external" href="https://xgboost.readthedocs.io/en/latest/python/python_api.html#module-xgboost.sklearn">https://xgboost.readthedocs.io/en/latest/python/python_api.html#module-xgboost.sklearn</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – additional keyword arguments for XGBClassifier
(see <a class="reference external" href="https://xgboost.readthedocs.io/en/latest/parameter.html">https://xgboost.readthedocs.io/en/latest/parameter.html</a>)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.xgboost.XGBoostClassifier.compare_to_training_set">
<code class="sig-name descname">compare_to_training_set</code><span class="sig-paren">(</span><em class="sig-param">sample_id: str</em>, <em class="sig-param">plot_umap: bool = False</em>, <em class="sig-param">plot_phate: bool = False</em>, <em class="sig-param">root_population: str = None</em>, <em class="sig-param">sample_n: int = 50000</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.compare_to_training_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function. Given some sample ID for a sample associated to experiment, compare the outcome to
the training data; outcome given as a labelled scatter plot, with classified single cell data shown as
components following some dimensionality reduction procedure (default = PCA).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_id</strong> (<em>str</em>) – Name of sample to classify and compare to training data</p></li>
<li><p><strong>plot_umap</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, plot UMAP instead of PCA</p></li>
<li><p><strong>plot_phate</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, plot PHATE instead of PCA</p></li>
<li><p><strong>root_population</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of root population. If none given, use same population as training data</p></li>
<li><p><strong>sample_n</strong> (<em>int</em><em>, </em><em>(</em><em>default=50000</em><em>)</em>) – Number of cells to sample prior to dimensionality reduction procedure</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.xgboost.XGBoostClassifier.gridsearch">
<code class="sig-name descname">gridsearch</code><span class="sig-paren">(</span><em class="sig-param">param_grid: dict</em>, <em class="sig-param">scoring: str = 'f1_weighted'</em>, <em class="sig-param">n_jobs: int = -1</em>, <em class="sig-param">cv: int = 5</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.gridsearch" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform Grid-Search for hyper-parameter optimisation using Scikit-Learn GridSearchCV class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_grid</strong> (<em>dict</em><em> or </em><em>list</em>) – (see <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a>)</p></li>
<li><p><strong>scoring</strong> (<em>str</em><em>, </em><em>(</em><em>default='f1_weighted'</em><em>)</em>) – Scaring function to use</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em>, </em><em>(</em><em>default=-1</em><em>)</em>) – Number of jobs to run in parallel (-1 will use all available cores)</p></li>
<li><p><strong>cv</strong> (<em>int</em><em>, </em><em>(</em><em>default=5</em><em>)</em>) – Number of folds for cross-validation</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments to be passed to GridSearchCV</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>GridSearchCV</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.xgboost.XGBoostClassifier.manual_validation">
<code class="sig-name descname">manual_validation</code><span class="sig-paren">(</span><em class="sig-param">sample_id: str</em>, <em class="sig-param">print_report_card: bool = False</em>, <em class="sig-param">root_population: str = None</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.manual_validation" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform manual validation of the classifier using a sample associated to the same experiment as the
training data. Important: the sample given MUST be pre-gated with the same populations as the training dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_population</strong> (<em>str</em><em>, </em><em>(</em><em>optional</em><em>)</em>) – Name of root population. If none given, defaults to root population used in training.</p></li>
<li><p><strong>sample_id</strong> (<em>str</em>) – sample ID for file group to classify</p></li>
<li><p><strong>print_report_card</strong> (<em>bool</em>) – If True, detailed classification report printed to stdout</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame of classification performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.xgboost.XGBoostClassifier.multiclass_labels">
<code class="sig-name descname">multiclass_labels</code><span class="sig-paren">(</span><em class="sig-param">ref: cytopy.flow.gating.actions.Gating</em>, <em class="sig-param">features: list</em>, <em class="sig-param">root_pop: str) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em>, <em class="sig-param">&lt;class 'dict'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.multiclass_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate feature space and labels for a multi-label multi-class classification problem and handle the
multi-label aspect of this problem by converting multi-label signatures to single labels. This can be important
if there are correlations between labels e.g. the classification CD3+/- and CD4+/- are not independent because
a cell that is CD4+, CD3- will have a very different meaning to a cell that is CD4+ CD3+. The problem is
converted to a multi class, single label classification by converting each unique one-hot encoded representation
to a ‘fake label’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ref</strong> (<a class="reference internal" href="cytopy.flow.gating.actions.html#cytopy.flow.gating.actions.Gating" title="cytopy.flow.gating.actions.Gating"><em>Gating</em></a>) – Gating object to retrieve data from</p></li>
<li><p><strong>features</strong> (<em>list</em>) – list of features for training</p></li>
<li><p><strong>root_pop</strong> (<em>str</em>) – name of the root population</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame of feature space, array of target labels, and a dictionary of cell population mappings</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.xgboost.XGBoostClassifier.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">target_sample: str</em>, <em class="sig-param">return_gating: bool = True</em>, <em class="sig-param">root_population: str = None</em><span class="sig-paren">)</span> &#x2192; cytopy.flow.gating.actions.Gating<a class="headerlink" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a sample ID, predict cell populations. Model must already be trained. Results are saved as new
populations in a Gating object returned to the user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_sample</strong> (<em>str</em>) – Name of file for prediction. Must belong to experiment associated to CellClassifier obj.</p></li>
<li><p><strong>return_gating</strong> (<em>bool</em><em>, </em><em>(</em><em>default=True</em><em>)</em>) – If True, returns the modified Gating object with predicted populations contained within</p></li>
<li><p><strong>root_population</strong> (<em>str</em>) – Name of root population</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gating object containing new predicted populations or tuple of (predicted probabilities, predicted labels)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="cytopy.flow.gating.actions.html#cytopy.flow.gating.actions.Gating" title="cytopy.flow.gating.actions.Gating">Gating</a> or (Numpy.array, Numpy.array)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.xgboost.XGBoostClassifier.singleclass_labels">
<code class="sig-name descname">singleclass_labels</code><span class="sig-paren">(</span><em class="sig-param">ref: cytopy.flow.gating.actions.Gating</em>, <em class="sig-param">features: list</em>, <em class="sig-param">root_pop: str) -&gt; (&lt;class 'pandas.core.frame.DataFrame'&gt;</em>, <em class="sig-param">&lt;built-in function array&gt;</em>, <em class="sig-param">&lt;class 'dict'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.singleclass_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate feature space and labels where a cell can belong to only one population</p>
<dl class="simple">
<dt>ref: Gating</dt><dd><p>Gating object to retrieve data from</p>
</dd>
<dt>features: list</dt><dd><p>list of features for training</p>
</dd>
<dt>root_pop: str</dt><dd><p>name of the root population</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>DataFrame of feature space, array of target labels, mappings of cell population labels</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>(Pandas.DataFrame, Numpy.array, dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.xgboost.XGBoostClassifier.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train classifier</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – Additional keyword arguments to be passed to call to MODEL.train()</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.xgboost.XGBoostClassifier.train_cv">
<code class="sig-name descname">train_cv</code><span class="sig-paren">(</span><em class="sig-param">k: int = 5</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.train_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit classifier to training data using cross-validation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>k</strong> (<em>int</em><em>, </em><em>(</em><em>default=5</em><em>)</em>) – Number of folds for cross-validation (default = 5)</p></li>
<li><p><strong>kwargs</strong> – Optional additional kwargs for model fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame detailing performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.xgboost.XGBoostClassifier.train_holdout">
<code class="sig-name descname">train_holdout</code><span class="sig-paren">(</span><em class="sig-param">holdout_frac: float = 0.3</em>, <em class="sig-param">print_report_card: bool = False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="headerlink" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.train_holdout" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit classifier to training data and evaluate on holdout data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>holdout_frac</strong> (<em>float</em><em>, </em><em>(</em><em>default=0.3</em><em>)</em>) – Proportion of data to keep as holdout</p></li>
<li><p><strong>print_report_card</strong> (<em>bool</em><em>, </em><em>(</em><em>default=False</em><em>)</em>) – If True, detailed classification report printed to stdout</p></li>
<li><p><strong>kwargs</strong> – Optional additional kwargs for model fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pandas DataFrame detailing performance</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="cytopy.flow.supervised.xgboost.XGBoostClassifier.train_test_split">
<code class="sig-name descname">train_test_split</code><span class="sig-paren">(</span><em class="sig-param">test_size: float = 0.3</em><span class="sig-paren">)</span> &#x2192; list<a class="headerlink" href="#cytopy.flow.supervised.xgboost.XGBoostClassifier.train_test_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Create train/test split of data using Sklearn’s train_test_split function
(<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>test_size</strong> (<em>float</em>) – size of test population as a proportion of the the dataset (default = 0.3)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List containing train-test split of inputs.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cytopy.flow.clustering.html" class="btn btn-neutral float-right" title="cytopy.flow.clustering" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cytopy.flow.gating.utilities.html" class="btn btn-neutral float-left" title="cytopy.flow.gating.utilities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Ross Burton

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>